{
  "hash": "6cf58f5043c4f30793bda9b05dc29c43",
  "result": {
    "markdown": "---\ntitle: \"Missende waarden\"\ndescription: |\n     Over het pakket `mice` en missende waarden\nauthor: \"Michy Allice, bewerking HarrieJonkman\"\ndate: \"2022-05-08\"\ncategories: [theorie, voorbereiden, modelleren]\nimage: \"Screenshot.png\"\n---\n\n\n![](Screenshot.png)\n\n## Data imputeren met R; het `MICE` pakket\n\n## Inleiding\nOnlangs gaf Stef van Buuren een verhelderende introductie op het pakket `mice` dat hij de laatste jaren ontwikkeld heeft en dat een standaardpakket geworden is om missende data om te gaan. Zijn presentatie is hier te vinden [slides](https://nscrweb.netlify.app/posts/2022-04-28-multiple-imputation-in-r/). Hij verwees tijdens de presentatie naar het artikel dat hij hierover eerder schreef (Van Buuren, and Groothuis-Oudshoorn, 2011)[hier]([mice: Multivariate Imputation by Chained Equations in R by Stef van Buuren](https://www.jstatsoft.org/article/view/v045i03), het boek dat hij hierover maakte [hier](https://stefvanbuuren.name/fimd/) en ook verwees hij naar een korte Nederlandse talige introductie [hier](https://stefvanbuuren.name/publications/2012%20Vogelvlucht%20-%20STAtOR.pdf). Na zijn presentatie las ik via Rbloggers de korte post van Michy Allice  [hier](https://www.r-bloggers.com/2015/10/imputing-missing-data-with-r-mice-package/).Voor deze blog heb ik dat artile van Allice bewerkt. Tot slot las ik ook nog het boek van Heymans en Eekhout over dit onderwerp [hier](https://bookdown.org/mwheymans/bookmi/) dat ook goed is.\n\n## Het `mice`-pakket\n\nOntbrekende gegevens zijn niet zo'n triviaal probleem bij de analyse van een dataset. Het is meestal ook niet zo eenvoudig om er rekening mee te houden.\n\nAls de hoeveelheid ontbrekende gegevens zeer klein is in verhouding tot de grootte van de dataset, dan kan het weglaten van de weinige data met ontbrekende kenmerken de beste strategie zijn om de analyse niet te vertekenen,. Met hety weglaten van beschikbare datapunten verdwijnt een bepaalde hoeveelheid informatie. Afhankelijk van de situatie waarmee u te maken hebt, kunt u op zoek gaan naar andere oplossingen voordat u potentieel nuttige datapunten uit uw dataset verwijdert.\n\nHoewel sommige snelle oplossingen zoals het vervangen door het gemiddelde in sommige gevallen goed kunnen zijn, heb je met zulke eenvoudige benaderingen gewoonlijk bias in de data. Het toepassen van gemiddelde-substitutie laat het gemiddelde onveranderd (wat wenselijk is), maar vermindert de variantie, wat onwenselijk kan zijn.\n\n> Het `mice`pakket in R helpt bij het imputeren van ontbrekende waarden met plausibele gegevenswaarden. Deze plausibele waarden worden getrokken uit een distributie die speciaal ontworpen is voor elk ontbrekend datapunt.\n\nHieronder gaan we ontbrekende waarden imputeren met behulp van de dataset `airquality` (standaard beschikbaar in R).\nVoor dit blog verwijder ik een aantal datapunten uit de dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mice)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'mice'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    cbind, rbind\n```\n:::\n\n```{.r .cell-code}\ndata <- airquality\ndata[4:10,3] <- rep(NA,7)\ndata[1:5,4] <- NA\nsummary(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Ozone           Solar.R           Wind             Temp      \n Min.   :  1.00   Min.   :  7.0   Min.   : 1.700   Min.   :57.00  \n 1st Qu.: 18.00   1st Qu.:115.8   1st Qu.: 7.400   1st Qu.:73.00  \n Median : 31.50   Median :205.0   Median : 9.700   Median :79.00  \n Mean   : 42.13   Mean   :185.9   Mean   : 9.806   Mean   :78.28  \n 3rd Qu.: 63.25   3rd Qu.:258.8   3rd Qu.:11.500   3rd Qu.:85.00  \n Max.   :168.00   Max.   :334.0   Max.   :20.700   Max.   :97.00  \n NA's   :37       NA's   :7       NA's   :7        NA's   :5      \n     Month            Day      \n Min.   :5.000   Min.   : 1.0  \n 1st Qu.:6.000   1st Qu.: 8.0  \n Median :7.000   Median :16.0  \n Mean   :6.993   Mean   :15.8  \n 3rd Qu.:8.000   3rd Qu.:23.0  \n Max.   :9.000   Max.   :31.0  \n                               \n```\n:::\n:::\n\n\nWat categorische variabelen betreft, is het vervangen van categorische variabelen gewoonlijk niet aan te bevelen. Het is wel gebruikelijk om ontbrekende categorische variabelen te vervangen door de modus van de waargenomen variabelen, maar het is de vraag of dat een goede keuze is. Ook al ontbreken er in dit geval geen datapunten van de categorische variabelen (Month, Day), we verwijderen ze uit onze dataset (we kunnen ze later weer toevoegen als dat nodig is) en bekijken de gegevens met `summary()`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data[-c(5,6)]\nsummary(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Ozone           Solar.R           Wind             Temp      \n Min.   :  1.00   Min.   :  7.0   Min.   : 1.700   Min.   :57.00  \n 1st Qu.: 18.00   1st Qu.:115.8   1st Qu.: 7.400   1st Qu.:73.00  \n Median : 31.50   Median :205.0   Median : 9.700   Median :79.00  \n Mean   : 42.13   Mean   :185.9   Mean   : 9.806   Mean   :78.28  \n 3rd Qu.: 63.25   3rd Qu.:258.8   3rd Qu.:11.500   3rd Qu.:85.00  \n Max.   :168.00   Max.   :334.0   Max.   :20.700   Max.   :97.00  \n NA's   :37       NA's   :7       NA's   :7        NA's   :5      \n```\n:::\n:::\n\nOzon is blijkbaar de variabele met de meeste ontbrekende datapunten. Hieronder gaan we dieper in op de ontbrekende datapatronen.\n\n## Snelle classificatie van ontbrekende gegevens\nEr zijn twee soorten ontbrekende gegevens:\n\n- MCAR: volledig willekeurig ontbrekend. Dit is het wenselijke scenario in geval van ontbrekende data.   \n- MNAR: missing not at random. Niet-willekeurig ontbrekende gegevens zijn een ernstiger probleem en in dit geval kan het verstandig zijn het proces van gegevensverzameling verder te controleren en te proberen te begrijpen waarom de informatie ontbreekt. Als bijvoorbeeld de meeste mensen in een enquête een bepaalde vraag niet hebben beantwoord, waarom hebben zij dat dan gedaan? Was de vraag onduidelijk?\n\nErvan uitgaande dat de gegevens MCAR zijn, kan een teveel aan ontbrekende gegevens ook een probleem zijn. Gewoonlijk is een veilige maximumdrempel 5% van het totaal voor grote datasets. Als de ontbrekende gegevens voor een bepaald kenmerk of een bepaalde steekproef meer dan 5% bedragen, moet u dat kenmerk of die steekproef waarschijnlijk weglaten. Daarom controleren we op kenmerken (kolommen) en steekproeven (rijen) waar meer dan 5% van de data ontbreekt met een eenvoudige functie\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npMiss <- function(x){sum(is.na(x))/length(x)*100}\napply(data,2,pMiss)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    Ozone   Solar.R      Wind      Temp \n24.183007  4.575163  4.575163  3.267974 \n```\n:::\n\n```{.r .cell-code}\napply(data,1,pMiss)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1]  25  25  25  50 100  50  25  25  25  50  25   0   0   0   0   0   0   0\n [19]   0   0   0   0   0   0  25  25  50   0   0   0   0  25  25  25  25  25\n [37]  25   0  25   0   0  25  25   0  25  25   0   0   0   0   0  25  25  25\n [55]  25  25  25  25  25  25  25   0   0   0  25   0   0   0   0   0   0  25\n [73]   0   0  25   0   0   0   0   0   0   0  25  25   0   0   0   0   0   0\n [91]   0   0   0   0   0  25  25  25   0   0   0  25  25   0   0   0  25   0\n[109]   0   0   0   0   0   0  25   0   0   0  25   0   0   0   0   0   0   0\n[127]   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0\n[145]   0   0   0   0   0  25   0   0   0\n```\n:::\n:::\n\n\nWe zien dat Ozon bijna 25% van de datapunten mist, dus we kunnen overwegen om het uit de analyse te laten of meer metingen te verzamelen. De andere variabelen blijven onder de drempel van 5%, zodat we ze kunnen behouden. Wat de data betreft, leidt het ontbreken van slechts één kenmerk tot 25% ontbrekende gegevens per dataset. \n\n## Gebruik `mice voor het bekijken van ontbrekende data patronen\n\nHet `mice` pakket biedt een mooie functie `md.pattern()` om een beter inzicht te krijgen in het patroon van ontbrekende gegevens.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmd.pattern(data)\n```\n\n::: {.cell-output-display}\n![](missende-waarden_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n    Temp Solar.R Wind Ozone   \n104    1       1    1     1  0\n34     1       1    1     0  1\n3      1       1    0     1  1\n1      1       1    0     0  2\n4      1       0    1     1  1\n1      1       0    1     0  2\n1      1       0    0     1  2\n3      0       1    1     1  1\n1      0       1    0     1  2\n1      0       0    0     0  4\n       5       7    7    37 56\n```\n:::\n:::\n\n\nDe output vertelt ons dat 104 gegevens compleet zijn, 34 data missen alleen de Ozonmeting, 3 data missen alleen de Solar.R waarde enzovoort.\n\nEen wellicht meer behulpzame visuele weergave kan worden verkregen met behulp van het VIM pakket als volgt\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(VIM)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: colorspace\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: grid\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nVIM is ready to use.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nSuggestions and bug-reports can be submitted at: https://github.com/statistikat/VIM/issues\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'VIM'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:datasets':\n\n    sleep\n```\n:::\n\n```{.r .cell-code}\naggr_plot <- aggr(data, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(data), cex.axis=.7, gap=3, ylab=c(\"Histogram van missende data\",\"Patroon\"))\n```\n\n::: {.cell-output-display}\n![](missende-waarden_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n Variables sorted by number of missings: \n Variable      Count\n    Ozone 0.24183007\n  Solar.R 0.04575163\n     Wind 0.04575163\n     Temp 0.03267974\n```\n:::\n:::\n\n\nUit de grafiek kunnen we opmaken dat bij bijna 70% van de data geen informatie ontbreekt, bij 22% ontbreekt de ozonwaarde en bij de overige variabelen ontbreekt zo'n 5%. Door deze aanpak ziet de situatie er naar mijn mening een stuk duidelijker uit.\n\nEen andere (hopelijk) behulpzame visuele benadering is een speciale boxplot \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmarginplot(data[c(1,2)])\n```\n\n::: {.cell-output-display}\n![](missende-waarden_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nUiteraard zijn we hier beperkt tot het plotten van slechts 2 variabelen tegelijk, maar desalniettemin kunnen we hier een aantal interessante inzichten uit verkrijgen. De rode boxplot links toont de verdeling van Solar.R waarbij Ozone ontbreekt, terwijl de blauwe boxplot de verdeling van de resterende datapunten toont. Hetzelfde geldt voor de boxplots van Ozone onderaan de grafiek. Als onze aanname van MCAR-gegevens juist is, dan verwachten we dat de rode en blauwe boxplots sterk op elkaar lijken.\n\n\n## Imputeren van  missende data\nDe `mice()` functie zorgt voor het imputatieprocess\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntempData <- mice(data,m=5,maxit=50,meth='pmm',seed=500)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n iter imp variable\n  1   1  Ozone  Solar.R  Wind  Temp\n  1   2  Ozone  Solar.R  Wind  Temp\n  1   3  Ozone  Solar.R  Wind  Temp\n  1   4  Ozone  Solar.R  Wind  Temp\n  1   5  Ozone  Solar.R  Wind  Temp\n  2   1  Ozone  Solar.R  Wind  Temp\n  2   2  Ozone  Solar.R  Wind  Temp\n  2   3  Ozone  Solar.R  Wind  Temp\n  2   4  Ozone  Solar.R  Wind  Temp\n  2   5  Ozone  Solar.R  Wind  Temp\n  3   1  Ozone  Solar.R  Wind  Temp\n  3   2  Ozone  Solar.R  Wind  Temp\n  3   3  Ozone  Solar.R  Wind  Temp\n  3   4  Ozone  Solar.R  Wind  Temp\n  3   5  Ozone  Solar.R  Wind  Temp\n  4   1  Ozone  Solar.R  Wind  Temp\n  4   2  Ozone  Solar.R  Wind  Temp\n  4   3  Ozone  Solar.R  Wind  Temp\n  4   4  Ozone  Solar.R  Wind  Temp\n  4   5  Ozone  Solar.R  Wind  Temp\n  5   1  Ozone  Solar.R  Wind  Temp\n  5   2  Ozone  Solar.R  Wind  Temp\n  5   3  Ozone  Solar.R  Wind  Temp\n  5   4  Ozone  Solar.R  Wind  Temp\n  5   5  Ozone  Solar.R  Wind  Temp\n  6   1  Ozone  Solar.R  Wind  Temp\n  6   2  Ozone  Solar.R  Wind  Temp\n  6   3  Ozone  Solar.R  Wind  Temp\n  6   4  Ozone  Solar.R  Wind  Temp\n  6   5  Ozone  Solar.R  Wind  Temp\n  7   1  Ozone  Solar.R  Wind  Temp\n  7   2  Ozone  Solar.R  Wind  Temp\n  7   3  Ozone  Solar.R  Wind  Temp\n  7   4  Ozone  Solar.R  Wind  Temp\n  7   5  Ozone  Solar.R  Wind  Temp\n  8   1  Ozone  Solar.R  Wind  Temp\n  8   2  Ozone  Solar.R  Wind  Temp\n  8   3  Ozone  Solar.R  Wind  Temp\n  8   4  Ozone  Solar.R  Wind  Temp\n  8   5  Ozone  Solar.R  Wind  Temp\n  9   1  Ozone  Solar.R  Wind  Temp\n  9   2  Ozone  Solar.R  Wind  Temp\n  9   3  Ozone  Solar.R  Wind  Temp\n  9   4  Ozone  Solar.R  Wind  Temp\n  9   5  Ozone  Solar.R  Wind  Temp\n  10   1  Ozone  Solar.R  Wind  Temp\n  10   2  Ozone  Solar.R  Wind  Temp\n  10   3  Ozone  Solar.R  Wind  Temp\n  10   4  Ozone  Solar.R  Wind  Temp\n  10   5  Ozone  Solar.R  Wind  Temp\n  11   1  Ozone  Solar.R  Wind  Temp\n  11   2  Ozone  Solar.R  Wind  Temp\n  11   3  Ozone  Solar.R  Wind  Temp\n  11   4  Ozone  Solar.R  Wind  Temp\n  11   5  Ozone  Solar.R  Wind  Temp\n  12   1  Ozone  Solar.R  Wind  Temp\n  12   2  Ozone  Solar.R  Wind  Temp\n  12   3  Ozone  Solar.R  Wind  Temp\n  12   4  Ozone  Solar.R  Wind  Temp\n  12   5  Ozone  Solar.R  Wind  Temp\n  13   1  Ozone  Solar.R  Wind  Temp\n  13   2  Ozone  Solar.R  Wind  Temp\n  13   3  Ozone  Solar.R  Wind  Temp\n  13   4  Ozone  Solar.R  Wind  Temp\n  13   5  Ozone  Solar.R  Wind  Temp\n  14   1  Ozone  Solar.R  Wind  Temp\n  14   2  Ozone  Solar.R  Wind  Temp\n  14   3  Ozone  Solar.R  Wind  Temp\n  14   4  Ozone  Solar.R  Wind  Temp\n  14   5  Ozone  Solar.R  Wind  Temp\n  15   1  Ozone  Solar.R  Wind  Temp\n  15   2  Ozone  Solar.R  Wind  Temp\n  15   3  Ozone  Solar.R  Wind  Temp\n  15   4  Ozone  Solar.R  Wind  Temp\n  15   5  Ozone  Solar.R  Wind  Temp\n  16   1  Ozone  Solar.R  Wind  Temp\n  16   2  Ozone  Solar.R  Wind  Temp\n  16   3  Ozone  Solar.R  Wind  Temp\n  16   4  Ozone  Solar.R  Wind  Temp\n  16   5  Ozone  Solar.R  Wind  Temp\n  17   1  Ozone  Solar.R  Wind  Temp\n  17   2  Ozone  Solar.R  Wind  Temp\n  17   3  Ozone  Solar.R  Wind  Temp\n  17   4  Ozone  Solar.R  Wind  Temp\n  17   5  Ozone  Solar.R  Wind  Temp\n  18   1  Ozone  Solar.R  Wind  Temp\n  18   2  Ozone  Solar.R  Wind  Temp\n  18   3  Ozone  Solar.R  Wind  Temp\n  18   4  Ozone  Solar.R  Wind  Temp\n  18   5  Ozone  Solar.R  Wind  Temp\n  19   1  Ozone  Solar.R  Wind  Temp\n  19   2  Ozone  Solar.R  Wind  Temp\n  19   3  Ozone  Solar.R  Wind  Temp\n  19   4  Ozone  Solar.R  Wind  Temp\n  19   5  Ozone  Solar.R  Wind  Temp\n  20   1  Ozone  Solar.R  Wind  Temp\n  20   2  Ozone  Solar.R  Wind  Temp\n  20   3  Ozone  Solar.R  Wind  Temp\n  20   4  Ozone  Solar.R  Wind  Temp\n  20   5  Ozone  Solar.R  Wind  Temp\n  21   1  Ozone  Solar.R  Wind  Temp\n  21   2  Ozone  Solar.R  Wind  Temp\n  21   3  Ozone  Solar.R  Wind  Temp\n  21   4  Ozone  Solar.R  Wind  Temp\n  21   5  Ozone  Solar.R  Wind  Temp\n  22   1  Ozone  Solar.R  Wind  Temp\n  22   2  Ozone  Solar.R  Wind  Temp\n  22   3  Ozone  Solar.R  Wind  Temp\n  22   4  Ozone  Solar.R  Wind  Temp\n  22   5  Ozone  Solar.R  Wind  Temp\n  23   1  Ozone  Solar.R  Wind  Temp\n  23   2  Ozone  Solar.R  Wind  Temp\n  23   3  Ozone  Solar.R  Wind  Temp\n  23   4  Ozone  Solar.R  Wind  Temp\n  23   5  Ozone  Solar.R  Wind  Temp\n  24   1  Ozone  Solar.R  Wind  Temp\n  24   2  Ozone  Solar.R  Wind  Temp\n  24   3  Ozone  Solar.R  Wind  Temp\n  24   4  Ozone  Solar.R  Wind  Temp\n  24   5  Ozone  Solar.R  Wind  Temp\n  25   1  Ozone  Solar.R  Wind  Temp\n  25   2  Ozone  Solar.R  Wind  Temp\n  25   3  Ozone  Solar.R  Wind  Temp\n  25   4  Ozone  Solar.R  Wind  Temp\n  25   5  Ozone  Solar.R  Wind  Temp\n  26   1  Ozone  Solar.R  Wind  Temp\n  26   2  Ozone  Solar.R  Wind  Temp\n  26   3  Ozone  Solar.R  Wind  Temp\n  26   4  Ozone  Solar.R  Wind  Temp\n  26   5  Ozone  Solar.R  Wind  Temp\n  27   1  Ozone  Solar.R  Wind  Temp\n  27   2  Ozone  Solar.R  Wind  Temp\n  27   3  Ozone  Solar.R  Wind  Temp\n  27   4  Ozone  Solar.R  Wind  Temp\n  27   5  Ozone  Solar.R  Wind  Temp\n  28   1  Ozone  Solar.R  Wind  Temp\n  28   2  Ozone  Solar.R  Wind  Temp\n  28   3  Ozone  Solar.R  Wind  Temp\n  28   4  Ozone  Solar.R  Wind  Temp\n  28   5  Ozone  Solar.R  Wind  Temp\n  29   1  Ozone  Solar.R  Wind  Temp\n  29   2  Ozone  Solar.R  Wind  Temp\n  29   3  Ozone  Solar.R  Wind  Temp\n  29   4  Ozone  Solar.R  Wind  Temp\n  29   5  Ozone  Solar.R  Wind  Temp\n  30   1  Ozone  Solar.R  Wind  Temp\n  30   2  Ozone  Solar.R  Wind  Temp\n  30   3  Ozone  Solar.R  Wind  Temp\n  30   4  Ozone  Solar.R  Wind  Temp\n  30   5  Ozone  Solar.R  Wind  Temp\n  31   1  Ozone  Solar.R  Wind  Temp\n  31   2  Ozone  Solar.R  Wind  Temp\n  31   3  Ozone  Solar.R  Wind  Temp\n  31   4  Ozone  Solar.R  Wind  Temp\n  31   5  Ozone  Solar.R  Wind  Temp\n  32   1  Ozone  Solar.R  Wind  Temp\n  32   2  Ozone  Solar.R  Wind  Temp\n  32   3  Ozone  Solar.R  Wind  Temp\n  32   4  Ozone  Solar.R  Wind  Temp\n  32   5  Ozone  Solar.R  Wind  Temp\n  33   1  Ozone  Solar.R  Wind  Temp\n  33   2  Ozone  Solar.R  Wind  Temp\n  33   3  Ozone  Solar.R  Wind  Temp\n  33   4  Ozone  Solar.R  Wind  Temp\n  33   5  Ozone  Solar.R  Wind  Temp\n  34   1  Ozone  Solar.R  Wind  Temp\n  34   2  Ozone  Solar.R  Wind  Temp\n  34   3  Ozone  Solar.R  Wind  Temp\n  34   4  Ozone  Solar.R  Wind  Temp\n  34   5  Ozone  Solar.R  Wind  Temp\n  35   1  Ozone  Solar.R  Wind  Temp\n  35   2  Ozone  Solar.R  Wind  Temp\n  35   3  Ozone  Solar.R  Wind  Temp\n  35   4  Ozone  Solar.R  Wind  Temp\n  35   5  Ozone  Solar.R  Wind  Temp\n  36   1  Ozone  Solar.R  Wind  Temp\n  36   2  Ozone  Solar.R  Wind  Temp\n  36   3  Ozone  Solar.R  Wind  Temp\n  36   4  Ozone  Solar.R  Wind  Temp\n  36   5  Ozone  Solar.R  Wind  Temp\n  37   1  Ozone  Solar.R  Wind  Temp\n  37   2  Ozone  Solar.R  Wind  Temp\n  37   3  Ozone  Solar.R  Wind  Temp\n  37   4  Ozone  Solar.R  Wind  Temp\n  37   5  Ozone  Solar.R  Wind  Temp\n  38   1  Ozone  Solar.R  Wind  Temp\n  38   2  Ozone  Solar.R  Wind  Temp\n  38   3  Ozone  Solar.R  Wind  Temp\n  38   4  Ozone  Solar.R  Wind  Temp\n  38   5  Ozone  Solar.R  Wind  Temp\n  39   1  Ozone  Solar.R  Wind  Temp\n  39   2  Ozone  Solar.R  Wind  Temp\n  39   3  Ozone  Solar.R  Wind  Temp\n  39   4  Ozone  Solar.R  Wind  Temp\n  39   5  Ozone  Solar.R  Wind  Temp\n  40   1  Ozone  Solar.R  Wind  Temp\n  40   2  Ozone  Solar.R  Wind  Temp\n  40   3  Ozone  Solar.R  Wind  Temp\n  40   4  Ozone  Solar.R  Wind  Temp\n  40   5  Ozone  Solar.R  Wind  Temp\n  41   1  Ozone  Solar.R  Wind  Temp\n  41   2  Ozone  Solar.R  Wind  Temp\n  41   3  Ozone  Solar.R  Wind  Temp\n  41   4  Ozone  Solar.R  Wind  Temp\n  41   5  Ozone  Solar.R  Wind  Temp\n  42   1  Ozone  Solar.R  Wind  Temp\n  42   2  Ozone  Solar.R  Wind  Temp\n  42   3  Ozone  Solar.R  Wind  Temp\n  42   4  Ozone  Solar.R  Wind  Temp\n  42   5  Ozone  Solar.R  Wind  Temp\n  43   1  Ozone  Solar.R  Wind  Temp\n  43   2  Ozone  Solar.R  Wind  Temp\n  43   3  Ozone  Solar.R  Wind  Temp\n  43   4  Ozone  Solar.R  Wind  Temp\n  43   5  Ozone  Solar.R  Wind  Temp\n  44   1  Ozone  Solar.R  Wind  Temp\n  44   2  Ozone  Solar.R  Wind  Temp\n  44   3  Ozone  Solar.R  Wind  Temp\n  44   4  Ozone  Solar.R  Wind  Temp\n  44   5  Ozone  Solar.R  Wind  Temp\n  45   1  Ozone  Solar.R  Wind  Temp\n  45   2  Ozone  Solar.R  Wind  Temp\n  45   3  Ozone  Solar.R  Wind  Temp\n  45   4  Ozone  Solar.R  Wind  Temp\n  45   5  Ozone  Solar.R  Wind  Temp\n  46   1  Ozone  Solar.R  Wind  Temp\n  46   2  Ozone  Solar.R  Wind  Temp\n  46   3  Ozone  Solar.R  Wind  Temp\n  46   4  Ozone  Solar.R  Wind  Temp\n  46   5  Ozone  Solar.R  Wind  Temp\n  47   1  Ozone  Solar.R  Wind  Temp\n  47   2  Ozone  Solar.R  Wind  Temp\n  47   3  Ozone  Solar.R  Wind  Temp\n  47   4  Ozone  Solar.R  Wind  Temp\n  47   5  Ozone  Solar.R  Wind  Temp\n  48   1  Ozone  Solar.R  Wind  Temp\n  48   2  Ozone  Solar.R  Wind  Temp\n  48   3  Ozone  Solar.R  Wind  Temp\n  48   4  Ozone  Solar.R  Wind  Temp\n  48   5  Ozone  Solar.R  Wind  Temp\n  49   1  Ozone  Solar.R  Wind  Temp\n  49   2  Ozone  Solar.R  Wind  Temp\n  49   3  Ozone  Solar.R  Wind  Temp\n  49   4  Ozone  Solar.R  Wind  Temp\n  49   5  Ozone  Solar.R  Wind  Temp\n  50   1  Ozone  Solar.R  Wind  Temp\n  50   2  Ozone  Solar.R  Wind  Temp\n  50   3  Ozone  Solar.R  Wind  Temp\n  50   4  Ozone  Solar.R  Wind  Temp\n  50   5  Ozone  Solar.R  Wind  Temp\n```\n:::\n\n```{.r .cell-code}\nsummary(tempData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nClass: mids\nNumber of multiple imputations:  5 \nImputation methods:\n  Ozone Solar.R    Wind    Temp \n  \"pmm\"   \"pmm\"   \"pmm\"   \"pmm\" \nPredictorMatrix:\n        Ozone Solar.R Wind Temp\nOzone       0       1    1    1\nSolar.R     1       0    1    1\nWind        1       1    0    1\nTemp        1       1    1    0\n```\n:::\n:::\n\n\nEen paar opmerkingen over de parameters:\n\n- `m=5` verwijst naar het aantal geïmputeerde datasets. Vijf is de standaard waarde.    \n- `meth='pmm'` verwijst naar de imputatie methode. In dit geval gebruiken we pmm (predictive mean matching) als imputatiemethode. Er kunnen ook andere imputatiemethoden worden gebruikt, type `methods(mice)` voor een lijst van de beschikbare imputatiemethoden.\n\nAls u de geïmputeerde gegevens wilt controleren, bijvoorbeeld voor de variabele Ozon, moet u de volgende regel code invoeren\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntempData$imp$Ozone\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     1   2   3   4   5\n5   13  19  12 115  63\n10  30  12  13  21   7\n25   8  28   6  18  28\n26   9  32   4  18  37\n27  37  21   4  32  32\n32  40  39  35  32  47\n33  44  28  36  52  20\n34  20  23  37  37  19\n35  32  28  16  32  35\n36  89  80  48  49 115\n37  18   7  16  30  22\n39  96  77 135  76  85\n42  50 168  64  50  41\n43  96  78  96  96  78\n45  63  20  18  24  31\n46  71  37  20  20  28\n52  20  35  37  63  63\n53  16  78  73  48 115\n54  59  35  46  44  23\n55  16  39  28  40  49\n56  24  36  52  21  44\n57  36  20  20  18  23\n58  11  11  24   7  23\n59  44  13  23  23  27\n60  23   4  19   4  32\n61  44  16  46  37  35\n65  30  23  65  30  30\n72  45  37  63  63  44\n75  39  46  32  39  28\n83  37  40  59  32  35\n84  40  59  28  28  35\n102 61  85  96  79  78\n103 31  59  20  31  36\n107 32  24  11  21  21\n115 52  16  11  14  13\n119 78  96 168  76  50\n150 14  12  13  23  11\n```\n:::\n:::\n\n\nDe uitvoer toont de geïmputeerde data voor elke observatie (eerste kolom links) binnen elke geïmputeerde dataset (eerste rij bovenaan). Als u de gebruikte imputatiemethode voor elke variabele wilt controleren, kunt u dat met `mice` heel eenvoudig doen\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntempData$meth\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Ozone Solar.R    Wind    Temp \n  \"pmm\"   \"pmm\"   \"pmm\"   \"pmm\" \n```\n:::\n:::\n\n\nNu kunnen we de voltooide dataset terugkrijgen met de `complete()`functie. Het is bijna gewoon Engels:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompletedData <- complete(tempData,1)\n```\n:::\n\n\nDe ontbrekende waarden zijn vervangen door de geïmputeerde waarden in de eerste van de vijf datasets. Als je een andere wilt gebruiken, verander dan de tweede parameter in de `complete()` functie.\n\n## De verdeling van de originele en geïmputeerde data bekijken\nLaten we de verdelingen van de originele en geïmputeerde data vergelijken met behulp van een aantal handige plots.\nAllereerst kunnen we een scatterplot gebruiken en Ozon uitzetten tegen alle andere variabelen.\n\nHier is dat het geval:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxyplot(tempData,Ozone ~ Wind+Temp+Solar.R,pch=18,cex=1)\n```\n\n::: {.cell-output-display}\n![](missende-waarden_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nWat wij willen zien is dat de vorm van de magenta punten (geïmputeerd) overeenkomt met de vorm van de blauwe punten (waargenomen). De overeenkomstige vorm zegt ons dat de geïmputeerde waarden inderdaad \"plausibele waarden\" zijn.\nEen andere nuttige grafiek is de densitygrafiek:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndensityplot(tempData)\n```\n\n::: {.cell-output-display}\n![](missende-waarden_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nDe dichtheid van de geïmputeerde gegevens voor elke geïmputeerde dataset wordt getoond in magenta, terwijl de dichtheid van de waargenomen gegevens in blauw wordt getoond. Nogmaals, onder onze eerdere aannames verwachten we dat de verdelingen vergelijkbaar zijn.\n\nEen andere nuttige visuele kijk op de verdelingen kan worden verkregen met de `stripplot()` functie die de verdelingen van de variabelen als afzonderlijke punten toont\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstripplot(tempData, pch = 20, cex = 1.2)\n```\n\n::: {.cell-output-display}\n![](missende-waarden_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n## Pooling\nVeronderstel dat de volgende stap in onze analyse erin bestaat een lineair model op de gegevens toe te passen. Dan kun je je afvragen welke geïmputeerde dataset je moet kiezen. Het `mice` pakket maakt het weer heel gemakkelijk om een model te passen op elk van de geïmputeerde datasets en dan deze resultaten samen te voegen\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelFit1 <- with(tempData,lm(Temp~ Ozone+Solar.R+Wind))\nsummary(pool(modelFit1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         term    estimate   std.error statistic        df      p.value\n1 (Intercept) 72.70719792 2.761360433 26.330209 117.27936 0.000000e+00\n2       Ozone  0.15924872 0.025914423  6.145177  49.30693 1.367056e-07\n3     Solar.R  0.01252384 0.008678358  1.443112  18.19046 1.659893e-01\n4        Wind -0.34547006 0.207866970 -1.661977 123.65905 9.905045e-02\n```\n:::\n:::\n\n\nDe variabele `modelFit1` bevat de resultaten van de aanpassing die is uitgevoerd over de geïmputeerde datasets, terwijl de `pool()` functie ze allemaal samenvoegt. Blijkbaar is alleen de Ozon variabele statistisch significant.\n\nVergeet niet dat we de `mice`-functie hebben geïnitialiseerd met een specifieke 'seed'-instelling. Daarom zijn de resultaten enigszins afhankelijk van onze initiële keuze. Om dit effect te verminderen, kunnen we een hoger aantal datasets toerekenen, door de standaard `m=5` parameter in de `mice()` functie als volgt te wijzigen\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntempData2 <- mice(data,m=50,seed=245435)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n iter imp variable\n  1   1  Ozone  Solar.R  Wind  Temp\n  1   2  Ozone  Solar.R  Wind  Temp\n  1   3  Ozone  Solar.R  Wind  Temp\n  1   4  Ozone  Solar.R  Wind  Temp\n  1   5  Ozone  Solar.R  Wind  Temp\n  1   6  Ozone  Solar.R  Wind  Temp\n  1   7  Ozone  Solar.R  Wind  Temp\n  1   8  Ozone  Solar.R  Wind  Temp\n  1   9  Ozone  Solar.R  Wind  Temp\n  1   10  Ozone  Solar.R  Wind  Temp\n  1   11  Ozone  Solar.R  Wind  Temp\n  1   12  Ozone  Solar.R  Wind  Temp\n  1   13  Ozone  Solar.R  Wind  Temp\n  1   14  Ozone  Solar.R  Wind  Temp\n  1   15  Ozone  Solar.R  Wind  Temp\n  1   16  Ozone  Solar.R  Wind  Temp\n  1   17  Ozone  Solar.R  Wind  Temp\n  1   18  Ozone  Solar.R  Wind  Temp\n  1   19  Ozone  Solar.R  Wind  Temp\n  1   20  Ozone  Solar.R  Wind  Temp\n  1   21  Ozone  Solar.R  Wind  Temp\n  1   22  Ozone  Solar.R  Wind  Temp\n  1   23  Ozone  Solar.R  Wind  Temp\n  1   24  Ozone  Solar.R  Wind  Temp\n  1   25  Ozone  Solar.R  Wind  Temp\n  1   26  Ozone  Solar.R  Wind  Temp\n  1   27  Ozone  Solar.R  Wind  Temp\n  1   28  Ozone  Solar.R  Wind  Temp\n  1   29  Ozone  Solar.R  Wind  Temp\n  1   30  Ozone  Solar.R  Wind  Temp\n  1   31  Ozone  Solar.R  Wind  Temp\n  1   32  Ozone  Solar.R  Wind  Temp\n  1   33  Ozone  Solar.R  Wind  Temp\n  1   34  Ozone  Solar.R  Wind  Temp\n  1   35  Ozone  Solar.R  Wind  Temp\n  1   36  Ozone  Solar.R  Wind  Temp\n  1   37  Ozone  Solar.R  Wind  Temp\n  1   38  Ozone  Solar.R  Wind  Temp\n  1   39  Ozone  Solar.R  Wind  Temp\n  1   40  Ozone  Solar.R  Wind  Temp\n  1   41  Ozone  Solar.R  Wind  Temp\n  1   42  Ozone  Solar.R  Wind  Temp\n  1   43  Ozone  Solar.R  Wind  Temp\n  1   44  Ozone  Solar.R  Wind  Temp\n  1   45  Ozone  Solar.R  Wind  Temp\n  1   46  Ozone  Solar.R  Wind  Temp\n  1   47  Ozone  Solar.R  Wind  Temp\n  1   48  Ozone  Solar.R  Wind  Temp\n  1   49  Ozone  Solar.R  Wind  Temp\n  1   50  Ozone  Solar.R  Wind  Temp\n  2   1  Ozone  Solar.R  Wind  Temp\n  2   2  Ozone  Solar.R  Wind  Temp\n  2   3  Ozone  Solar.R  Wind  Temp\n  2   4  Ozone  Solar.R  Wind  Temp\n  2   5  Ozone  Solar.R  Wind  Temp\n  2   6  Ozone  Solar.R  Wind  Temp\n  2   7  Ozone  Solar.R  Wind  Temp\n  2   8  Ozone  Solar.R  Wind  Temp\n  2   9  Ozone  Solar.R  Wind  Temp\n  2   10  Ozone  Solar.R  Wind  Temp\n  2   11  Ozone  Solar.R  Wind  Temp\n  2   12  Ozone  Solar.R  Wind  Temp\n  2   13  Ozone  Solar.R  Wind  Temp\n  2   14  Ozone  Solar.R  Wind  Temp\n  2   15  Ozone  Solar.R  Wind  Temp\n  2   16  Ozone  Solar.R  Wind  Temp\n  2   17  Ozone  Solar.R  Wind  Temp\n  2   18  Ozone  Solar.R  Wind  Temp\n  2   19  Ozone  Solar.R  Wind  Temp\n  2   20  Ozone  Solar.R  Wind  Temp\n  2   21  Ozone  Solar.R  Wind  Temp\n  2   22  Ozone  Solar.R  Wind  Temp\n  2   23  Ozone  Solar.R  Wind  Temp\n  2   24  Ozone  Solar.R  Wind  Temp\n  2   25  Ozone  Solar.R  Wind  Temp\n  2   26  Ozone  Solar.R  Wind  Temp\n  2   27  Ozone  Solar.R  Wind  Temp\n  2   28  Ozone  Solar.R  Wind  Temp\n  2   29  Ozone  Solar.R  Wind  Temp\n  2   30  Ozone  Solar.R  Wind  Temp\n  2   31  Ozone  Solar.R  Wind  Temp\n  2   32  Ozone  Solar.R  Wind  Temp\n  2   33  Ozone  Solar.R  Wind  Temp\n  2   34  Ozone  Solar.R  Wind  Temp\n  2   35  Ozone  Solar.R  Wind  Temp\n  2   36  Ozone  Solar.R  Wind  Temp\n  2   37  Ozone  Solar.R  Wind  Temp\n  2   38  Ozone  Solar.R  Wind  Temp\n  2   39  Ozone  Solar.R  Wind  Temp\n  2   40  Ozone  Solar.R  Wind  Temp\n  2   41  Ozone  Solar.R  Wind  Temp\n  2   42  Ozone  Solar.R  Wind  Temp\n  2   43  Ozone  Solar.R  Wind  Temp\n  2   44  Ozone  Solar.R  Wind  Temp\n  2   45  Ozone  Solar.R  Wind  Temp\n  2   46  Ozone  Solar.R  Wind  Temp\n  2   47  Ozone  Solar.R  Wind  Temp\n  2   48  Ozone  Solar.R  Wind  Temp\n  2   49  Ozone  Solar.R  Wind  Temp\n  2   50  Ozone  Solar.R  Wind  Temp\n  3   1  Ozone  Solar.R  Wind  Temp\n  3   2  Ozone  Solar.R  Wind  Temp\n  3   3  Ozone  Solar.R  Wind  Temp\n  3   4  Ozone  Solar.R  Wind  Temp\n  3   5  Ozone  Solar.R  Wind  Temp\n  3   6  Ozone  Solar.R  Wind  Temp\n  3   7  Ozone  Solar.R  Wind  Temp\n  3   8  Ozone  Solar.R  Wind  Temp\n  3   9  Ozone  Solar.R  Wind  Temp\n  3   10  Ozone  Solar.R  Wind  Temp\n  3   11  Ozone  Solar.R  Wind  Temp\n  3   12  Ozone  Solar.R  Wind  Temp\n  3   13  Ozone  Solar.R  Wind  Temp\n  3   14  Ozone  Solar.R  Wind  Temp\n  3   15  Ozone  Solar.R  Wind  Temp\n  3   16  Ozone  Solar.R  Wind  Temp\n  3   17  Ozone  Solar.R  Wind  Temp\n  3   18  Ozone  Solar.R  Wind  Temp\n  3   19  Ozone  Solar.R  Wind  Temp\n  3   20  Ozone  Solar.R  Wind  Temp\n  3   21  Ozone  Solar.R  Wind  Temp\n  3   22  Ozone  Solar.R  Wind  Temp\n  3   23  Ozone  Solar.R  Wind  Temp\n  3   24  Ozone  Solar.R  Wind  Temp\n  3   25  Ozone  Solar.R  Wind  Temp\n  3   26  Ozone  Solar.R  Wind  Temp\n  3   27  Ozone  Solar.R  Wind  Temp\n  3   28  Ozone  Solar.R  Wind  Temp\n  3   29  Ozone  Solar.R  Wind  Temp\n  3   30  Ozone  Solar.R  Wind  Temp\n  3   31  Ozone  Solar.R  Wind  Temp\n  3   32  Ozone  Solar.R  Wind  Temp\n  3   33  Ozone  Solar.R  Wind  Temp\n  3   34  Ozone  Solar.R  Wind  Temp\n  3   35  Ozone  Solar.R  Wind  Temp\n  3   36  Ozone  Solar.R  Wind  Temp\n  3   37  Ozone  Solar.R  Wind  Temp\n  3   38  Ozone  Solar.R  Wind  Temp\n  3   39  Ozone  Solar.R  Wind  Temp\n  3   40  Ozone  Solar.R  Wind  Temp\n  3   41  Ozone  Solar.R  Wind  Temp\n  3   42  Ozone  Solar.R  Wind  Temp\n  3   43  Ozone  Solar.R  Wind  Temp\n  3   44  Ozone  Solar.R  Wind  Temp\n  3   45  Ozone  Solar.R  Wind  Temp\n  3   46  Ozone  Solar.R  Wind  Temp\n  3   47  Ozone  Solar.R  Wind  Temp\n  3   48  Ozone  Solar.R  Wind  Temp\n  3   49  Ozone  Solar.R  Wind  Temp\n  3   50  Ozone  Solar.R  Wind  Temp\n  4   1  Ozone  Solar.R  Wind  Temp\n  4   2  Ozone  Solar.R  Wind  Temp\n  4   3  Ozone  Solar.R  Wind  Temp\n  4   4  Ozone  Solar.R  Wind  Temp\n  4   5  Ozone  Solar.R  Wind  Temp\n  4   6  Ozone  Solar.R  Wind  Temp\n  4   7  Ozone  Solar.R  Wind  Temp\n  4   8  Ozone  Solar.R  Wind  Temp\n  4   9  Ozone  Solar.R  Wind  Temp\n  4   10  Ozone  Solar.R  Wind  Temp\n  4   11  Ozone  Solar.R  Wind  Temp\n  4   12  Ozone  Solar.R  Wind  Temp\n  4   13  Ozone  Solar.R  Wind  Temp\n  4   14  Ozone  Solar.R  Wind  Temp\n  4   15  Ozone  Solar.R  Wind  Temp\n  4   16  Ozone  Solar.R  Wind  Temp\n  4   17  Ozone  Solar.R  Wind  Temp\n  4   18  Ozone  Solar.R  Wind  Temp\n  4   19  Ozone  Solar.R  Wind  Temp\n  4   20  Ozone  Solar.R  Wind  Temp\n  4   21  Ozone  Solar.R  Wind  Temp\n  4   22  Ozone  Solar.R  Wind  Temp\n  4   23  Ozone  Solar.R  Wind  Temp\n  4   24  Ozone  Solar.R  Wind  Temp\n  4   25  Ozone  Solar.R  Wind  Temp\n  4   26  Ozone  Solar.R  Wind  Temp\n  4   27  Ozone  Solar.R  Wind  Temp\n  4   28  Ozone  Solar.R  Wind  Temp\n  4   29  Ozone  Solar.R  Wind  Temp\n  4   30  Ozone  Solar.R  Wind  Temp\n  4   31  Ozone  Solar.R  Wind  Temp\n  4   32  Ozone  Solar.R  Wind  Temp\n  4   33  Ozone  Solar.R  Wind  Temp\n  4   34  Ozone  Solar.R  Wind  Temp\n  4   35  Ozone  Solar.R  Wind  Temp\n  4   36  Ozone  Solar.R  Wind  Temp\n  4   37  Ozone  Solar.R  Wind  Temp\n  4   38  Ozone  Solar.R  Wind  Temp\n  4   39  Ozone  Solar.R  Wind  Temp\n  4   40  Ozone  Solar.R  Wind  Temp\n  4   41  Ozone  Solar.R  Wind  Temp\n  4   42  Ozone  Solar.R  Wind  Temp\n  4   43  Ozone  Solar.R  Wind  Temp\n  4   44  Ozone  Solar.R  Wind  Temp\n  4   45  Ozone  Solar.R  Wind  Temp\n  4   46  Ozone  Solar.R  Wind  Temp\n  4   47  Ozone  Solar.R  Wind  Temp\n  4   48  Ozone  Solar.R  Wind  Temp\n  4   49  Ozone  Solar.R  Wind  Temp\n  4   50  Ozone  Solar.R  Wind  Temp\n  5   1  Ozone  Solar.R  Wind  Temp\n  5   2  Ozone  Solar.R  Wind  Temp\n  5   3  Ozone  Solar.R  Wind  Temp\n  5   4  Ozone  Solar.R  Wind  Temp\n  5   5  Ozone  Solar.R  Wind  Temp\n  5   6  Ozone  Solar.R  Wind  Temp\n  5   7  Ozone  Solar.R  Wind  Temp\n  5   8  Ozone  Solar.R  Wind  Temp\n  5   9  Ozone  Solar.R  Wind  Temp\n  5   10  Ozone  Solar.R  Wind  Temp\n  5   11  Ozone  Solar.R  Wind  Temp\n  5   12  Ozone  Solar.R  Wind  Temp\n  5   13  Ozone  Solar.R  Wind  Temp\n  5   14  Ozone  Solar.R  Wind  Temp\n  5   15  Ozone  Solar.R  Wind  Temp\n  5   16  Ozone  Solar.R  Wind  Temp\n  5   17  Ozone  Solar.R  Wind  Temp\n  5   18  Ozone  Solar.R  Wind  Temp\n  5   19  Ozone  Solar.R  Wind  Temp\n  5   20  Ozone  Solar.R  Wind  Temp\n  5   21  Ozone  Solar.R  Wind  Temp\n  5   22  Ozone  Solar.R  Wind  Temp\n  5   23  Ozone  Solar.R  Wind  Temp\n  5   24  Ozone  Solar.R  Wind  Temp\n  5   25  Ozone  Solar.R  Wind  Temp\n  5   26  Ozone  Solar.R  Wind  Temp\n  5   27  Ozone  Solar.R  Wind  Temp\n  5   28  Ozone  Solar.R  Wind  Temp\n  5   29  Ozone  Solar.R  Wind  Temp\n  5   30  Ozone  Solar.R  Wind  Temp\n  5   31  Ozone  Solar.R  Wind  Temp\n  5   32  Ozone  Solar.R  Wind  Temp\n  5   33  Ozone  Solar.R  Wind  Temp\n  5   34  Ozone  Solar.R  Wind  Temp\n  5   35  Ozone  Solar.R  Wind  Temp\n  5   36  Ozone  Solar.R  Wind  Temp\n  5   37  Ozone  Solar.R  Wind  Temp\n  5   38  Ozone  Solar.R  Wind  Temp\n  5   39  Ozone  Solar.R  Wind  Temp\n  5   40  Ozone  Solar.R  Wind  Temp\n  5   41  Ozone  Solar.R  Wind  Temp\n  5   42  Ozone  Solar.R  Wind  Temp\n  5   43  Ozone  Solar.R  Wind  Temp\n  5   44  Ozone  Solar.R  Wind  Temp\n  5   45  Ozone  Solar.R  Wind  Temp\n  5   46  Ozone  Solar.R  Wind  Temp\n  5   47  Ozone  Solar.R  Wind  Temp\n  5   48  Ozone  Solar.R  Wind  Temp\n  5   49  Ozone  Solar.R  Wind  Temp\n  5   50  Ozone  Solar.R  Wind  Temp\n```\n:::\n\n```{.r .cell-code}\nmodelFit2 <- with(tempData2,lm(Temp~ Ozone+Solar.R+Wind))\nsummary(pool(modelFit2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         term    estimate   std.error statistic        df      p.value\n1 (Intercept) 72.60178955 2.915916315 24.898448 105.59368 0.000000e+00\n2       Ozone  0.16345639 0.026054628  6.273603  99.86352 9.122568e-09\n3     Solar.R  0.01193645 0.007134344  1.673097 120.41496 9.690433e-02\n4        Wind -0.33592048 0.222350762 -1.510768 107.41496 1.337838e-01\n```\n:::\n:::\n\nNa aanpassing, krijgen we (in dit geval) min of meer dezelfde resultaten als voorheen, waarbij alleen Ozone statistische significantie vertoont.\n\nDe code kun je [hier](https://gist.github.com/mick001/df77b69b30ef6ff9fc0b) vinden.\n\n## Literatuur\n\nAlice, M. (2015). Imputing missing data with R; `mice`package. R-bloggers, 4-10-2015. https://www.r-bloggers.com/2015/10/imputing-missing-data-with-r-mice-package/\n\nHeymans, M. en Eekhout, I. (2019). *Applied Missing Data Analysis With SPSS and (R)Studio*. Amsterdam. https://bookdown.org/mwheymans/bookmi/\n\nVan Buuren, S. and Groothuis-Oudshoorn, C.G.M. (2011).`mice`: Multivariate Imputation by Chained Equations in R.\n*Journal of Statistical Software, 45(3)*, 1–67.\n\nVan Buuren (2012). *Multiple imputatie in vogelvlucht*. https://stefvanbuuren.name/publications/2012%20Vogelvlucht%20-%20STAtOR.pdf\n\nVan Buuren, S. (2018). *Flexible Imputation of Missing Data*. Second Edition. Chapman & Hall/CRC, Boca Raton, FL\n\n\n\n",
    "supporting": [
      "missende-waarden_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}