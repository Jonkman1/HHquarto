{
  "hash": "d59834168019229633a2d211233397dc",
  "result": {
    "markdown": "---\ntitle: \"Werken met moderne schattingstechnieken\"\ndescription: |\n    Hoe je schattingen maakt van uitkomsten door kennis van experts in te zetten, hoe zet je dit proces uit, hoe bereken je het en hoe combineer je deze kennis weer met data.\nauthor: \"HarrieJonkman\"\ndate: \"2022-12-08\"\ncategories: [modeling, Bayes]\nimage: \"Screenshot.PNG\"\n---\n\n\n\n\n![](Screenshot.PNG)\n\n## Inleiding\nEen belangrijk kenmerk van Bayesiaanse analyse is het incorporeren van kennis teneinde de kwaliteit van conclusies en voorspellingen te verbeteren. Dat is zeker belangrijk als er geen of beperkte data beschikbaar zijn. Kennis vooraf is er veelal voordat je met een onderzoek begint. Er zijn eerder studies gedaan of je kunt de kennis van experts gebruiken om deze priors te definiëren. In ieder geval is het belangrijk de kennis zichtbaar en expliciet te maken in je onderzoek zodat anderen het kunnen beoordelen en bekritiseren. \n\nIn deze blog laat ik zien hoe we de kennis van experts kunnen gebruiken om schattingen te maken. Hier wordt gebruik gemaakt van moderne schattingstechnieken en met name de SHELF-methode (Cooke, 1991; Cooke & Goossens, 1999; European Food Safety Authority, 2014; Gosling, 2018; Morris et al., 2014; O’Hagan et al., 2006; Zondervan-Zwijnenburg et al., 2017). Experts weten veel over een bepaald onderwerp maar hebben vaak moeite om goede schattingen te maken. De SHELF-methode helpt ons hier goed mee om te gaan en geeft praktische en statistische ondersteuning in het schattingsproces. Dat proces staat onder begeleiding van een **facilitator** die hierin is getraind. Zelf heb ik vlak voor het uitbreken van de coronaepidemie aan zo'n training van Tony O'Hagan meegedaan.\n\nHieronder beschrijf ik het schattingsproces van het SHeffield ELicitation Framework in het kort, dat in een aantal publicaties goed is omschreven (O’Hagan, 2019; O’Hagan et al., 2006; Oakley & O’Hagan, 2016). De data die in dit voorbeeld gebruikt worden sluiten aan bij het vierde hoofdstuk van het [Bayesrules! boek](https://www.bayesrulesbook.com/chapter-4.html)\n\nEerst maar eens een aantal pakketten openen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(SHELF)\nlibrary(bayesrules)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6      ✔ purrr   0.3.4 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.2      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(janitor)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'janitor'\n\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n```\n:::\n:::\n\n\n\nDe data gaan over de Bechdel-test, die iets zegt over de representatie van vrouwen in films. In het stripverhaal *The Rule van Alison Bechdel* uit 1985 stelt een personage dat ze een film alleen zien als die aan de volgende drie regels voldoet (Bechdel 1986):\n\n- in de film moeten minstens twee vrouwen voorkomen;\n   \n- deze twee vrouwen praten met elkaar; en   \n\n- ze praten over iets anders dan een man.\n\nDeze criteria vormen de Bechdel-test. Als je denkt aan films in de periode 1980-heden, welk percentage daarvan voldoet volgens jou aan de Bechdel-test? Is dat eerder 10%, 50%, 80% of 100%? \n\nStel dat je nu precies dat percentage wilt vaststellen. Precieze studies hierover zijn er vooralsnog niet en het enige dat je kunt doen is gebruik maken van de kennis van experts. Voor het schatten hiervan nodig je vier experts uit. \n\nDe elicitatiemethode om het percentage vast te stellen wordt in twee rondes met in totaal acht stappen uitgewerkt. Het resultaat kan al het een resultaat van een onderzoek zijn. In dit blog wordt het resultaat van zo'n expertschatting ook nog eens gekoppeld aan een klein onderzoek. De prior van de experts en de resultaten van dat onderzoek worden gecombineerd tot eindresultaat.\n\n\n## Eerste ronde van het Elicitatieproces\n\n1. *Definiëren van het problemem*: Om het percentage van de Bechdel-test vast te stellen gaan we met een groep van vier experts in gesprek. Voor de uitvoering van deze procedure is allereerst informatie verzameld over vrouwen in de film, hun rol daarin en aanvullende informatie. De drie regels waaraan de test moet voldoen is zo helder mogelijk gedefinieerd voor de experts, \n2. *Selecteren van experts*: Vervolgens is er een groep experts geselecteerd. Voor experts hebben we gezocht naar een goede mengeling uit filmwetenschap en -industrie. We hebben mensen betrokken die een goed begrip hebben van het probleem en ook openstaan voor andere meningen. Uiteindelijk is er gekozen voor vier experts: een algemene filmwetenschapster (A), een wetenschapster op het terrein van vrouwenstudies en film (B) en iemand uit de filmindustrie (C) en een cultuurwetenschapper (D).\n3. *Evidence dossier*: Voor de uitvoering van de procedure is een evidence dossier gemaakt, dat belangrijke informatie omvat waarmee experts hun mening over het percentage dat voldoet aan de Bechdel-test kunnen onderbouwen. Dat dossier is gevuld met informatie over het doel van het onderzoeksproject, met informatie over het eerder uitgevoerde filmonderzoek, praktijkonderzoek en enkele relevante meta-analyses die zijn uitgevoerd. Dit dossier is toegestuurd nadat experts waren uitgenodigd en hadden aangegeven dat ze willen deelnemen. Dit evidence-dossier is ook nog een keer doorgenomen toen de experts samenkwamen in de tweede ronde. \n4. *Trainen van experts*: De experts kregen een overzicht van het schattingsproces en het gebruik van subjectieve waarschijnlijkheid en waarschijnlijkheidsdistributies. De informatie over de procedure (eerst een mediaan (p50) en de andere twee tertielscores (p25 en p75) is in een kort document gezet, dat is toegestuurd. Het is verwerkt in een korte power-point presentatie bij de tweede ronde waarin de experts samenkwamen. \n5. *Schatten van individuele priors*: De vier individuele experts hebben in een eerste ronde individueel hun schattingen meegedeeld in een aangeleverd format. De experts ontvingen een eenvoudig gereedschap om de invloed van de werkzame elementen te schatten. Hier hebben we de tertielmanier toegepast: iedere deelnemer ontving 20 muntjes die ze moesten verdelen over een schattingsformulier van 0-100 met tientallen. Waar ligt de mediaan (p50). Dan de linkerhelft van de muntjes waar ligt hier de p25 grens/ Vervolgens de andere muntjes, waar ligt hier de p75-grens van de resterende muntjes? Schattingen van individuele priors zijn vervolgens door de facilitator zichtbaar gemaakt (experts wisten in deze fase niet wat anderen hebben geschat). De resultaten van de individuele schattingen zijn daarvoor verwerkt in het programma R met het pakket SHELF (Oakley& O’Hagan, 2019). \n\n## Resultaten eerste ronde in R bewerken\nDe resultaten van de vier experts zijn verwerkt met het pakket SHELF in R. Als je de volgende handeling uitvoert verschijnt het invoerprogramma.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(SHELF)\nelicitMultiple\n```\n:::\n\n\nJe kunt ook de [shiny-app](https://jeremy-oakley.shinyapps.io/SHELF-multiple/) openen.\n\nDe scores zie je hieronder.\n![hieronder](Screenshot.png) \n\nJe ziet de resultaten van de vier experts.    \n- Expert A zegt dat hij hierover niets durft te zeggen. De twintig muntjes heeft hij gelijk verdeeld over het formulier (twee muntjes per tiental). De mediaan ligt op 50 en de drie tertielen zijn gelijk verdeeld.     \n- Volgens Expert B voldoet het merendeel aan de test en zij legt de mediaan op 70 (tien muntjes ter linke en tien muntjes ter rechtezijde). Het 25ste percentiel ligt op 50 en het 75ste percentiel ligt op goed. Zij is de enige optimistische expert in dit gezelschap.    \n- Expert C legt de 50grens op 40, de 25grens op 30 en 75grens op 50. De resultaten liggen bij hem redelijk dicht bij elkaar en dat betekent dat hij redelijk zeker is van z'n zaak.     \n- Expert D legt de 50grens ook op 40, en wat dat betreft zijn C en D het met elkaar eens. Alleen deze expert is net iets minder zeker over deze zaak. Zij legt de 25grens op 10 en de 75grens op 70.\n\nDe resultaten van de individuele schattingen zijn vervolgens door de facilitator in het distributierapport ingevoerd en dat rapport vind je [hier](~/Desktop/elicitation/distributions-report.html)\n\nDe resultaten van de individuele schattingen kun je ook op een volgende manier uitschrijven.\n   \n- Expert A P(X ≤ 25) = 0.25, P(X ≤ 50) = 0.5, P(X ≤ 75) = 0.75,\n\n- Expert B P(X ≤ 50) = 0.25, P(X ≤ 70) = 0.5, P(X ≤ 90) = 0.75,\n\n- Expert C P(X ≤ 30) = 0.25, P(X ≤ 40) = 0.5, P(X ≤ 50) = 0.75,\n\n- expert D P(X ≤ 10) = 0.25, P(X ≤ 40) = 0.5, P(X ≤ 70) = 0.75,\n\nDeze resultaten kun je in R zichtbaar maken als vier distributies. Zo voer je het in:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv <- matrix(c(25, 50, 75, 50, 70, 90, 30, 40, 50, 10, 40, 70), nrow = 3, ncol = 4)\n\np <- c(0.25, 0.5, 0.75)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmyfit <- fitdist(vals = v, probs = p, lower = 0, upper = 100)\n```\n:::\n\n\nDit zijn dan de Beta's van de vier experts.\n\n::: {.cell}\n\n```{.r .cell-code}\nmyfit$Beta\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            shape1    shape2\nexpert.A 1.0000000 1.0000000\nexpert.B 1.5561883 0.7754301\nexpert.C 4.5012666 6.6327143\nexpert.D 0.5371061 0.7338722\n```\n:::\n:::\n\nEn dit zijn de distributies, inclusief het totaal resultaat (de resultaten van de vier experts samengebracht). Je ziet hier weer Expert A die hier niets over durft te zeggen, de optimistische Expert B, met de negatievere Expert C die redelijk zeker is over de zaak en de negatieve Expert D die meer onzeker is.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplotfit(myfit, lp = TRUE)\n```\n\n::: {.cell-output-display}\n![](expertsschattingen_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nDe gegevens van de eerste ronde kunnen in dit SHELF-document worden geplaatst. [hier](SHELF1.doc)\n\n## Tweede ronde van het Elicitatieproces \nBovenstaande kan de faciltator doen op basis van de individuele schattingen. In de tweede ronde worden de experts samengebracht. In die ronde worden de individuele resulaten zichtbaar gemaakt aan de experts, met elkaar besproken en geprobeerd op basis van een discussie tot een onderbouwd totaalresultaat te komen. In deze gezamenlijke tweede ronde worden de laatste drie stappen in het elicitatieproces gezet.\n\n6.\t*Bediscussiëren van indiviuele resultaten*   \nIn een tweede ronde worden de resultaten van individuele schattingen gedeeld en besproken, die ondertussen door de facilitator bewerkt en gevisualiseerd zijn, zoals hierboven besproken. De tertielen, het rapport en de distributies worden gepresenteerd en toegelicht door de facilitator. De experts lichten vervolgens de rationale van hun eigen overtuiging nog eens toe (waarom ze de uitkomst zo inschatten en hoe zeker ze zijn over hun eigen schatting). De overeenkomsten en verschillen worden zichtbaar gemaakt en de experts spreken met elkaar hierover door.\n \n\n7.\t*Overeenkomen op consensus prior*   \nDaarna identificeerden de experts vervolgens in deze tweede ronde (de eerste bijeenkomst met elkaar) ook het gedeelde percentage van de Bechdel-test. Hier wordt met elkaar als het ware een ‘consensus prior’ van de experts vastgesteld en vormen ze zo met elkaar het standpunt van de *Rationeel Onafhankelijke Observator* (Rational Impartial Observator). Op deze manier definiëren ze een voorstel (een schatting) waar ze het met elkaar over eens of, allicht beter geformuleerd, zoveel mogelijk over eens zijn. Deze totaalschatting is gebaseerd op de discussies die ondertussen met elkaar zijn gevoerd en laat de uitkomst zien waarin alle experts zich onder leiding van de facilitator kunnen vinden.\n\nStel dat in de discussie en lang beraad uiteindelijk wordt vastgesteld dat de P50-grens op 40 ligt, p25-grens op 25 en p75-grens op 55 ligt. Dit zetten we nogmaals in R.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nv <- matrix(c(25, 40, 55), nrow = 3, ncol = 1)\n\np <- c(0.25, 0.5, 0.75)\n\nmyfit <- fitdist(vals = v, probs = p, lower = 0, upper = 100)\n```\n:::\n\n\nDe beta's van deze totaalscore is dan:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyfit$Beta\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    shape1   shape2\n1 2.062969 2.982134\n```\n:::\n:::\n\nLaat $pi$, een willekeurige waarde tussen 0 en 1, staan voor het onbekende aandeel van recente films die de Bechdel-test doorstaan. Vier experts hebben voor de volgende totaalscore gekozen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_beta(2.06, 2.98) + ggtitle(\"Beta(2.06,2.98),Totaalscore experts\")\n```\n\n::: {.cell-output-display}\n![](expertsschattingen_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n8. *Documentatie*: Op basis van deze twee rondes hebben is een verslag in twee delen geschreven van het gehele identificatie en schattingsproces. De resultaten worden hieronder samengevat. \n\nDe gegevens van de tweede ronde kunnen in dit SHELF-document worden geplaatst. [hier](SHELF2.doc)\n\n## De posterior van de experts als prior gebruiken\n\nNu we dit weten van de experts besluiten we vervolgens een willekeurige steekproef van $n=20$ recente films te bekijken met behulp van gegevens die verzameld zijn over de Bechdel-test. Het pakket `bayesrules` bevat een gedeeltelijke versie van deze dataset, genaamd bechdel. Een volledige versie wordt geleverd door het pakket `fivethirtyeight R` (Kim, Ismay en Chunn 2020). Samen met de titel en het jaar van elke film in deze dataset, registreert de binaire variabele of de film de Bechdel-test heeft doorstaan of niet:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Importeer data\ndata(bechdel, package = \"bayesrules\")\n\n# Haal ert een sample uit van 20 films\nset.seed(84735)\nbechdel_20 <- bechdel %>% \n  sample_n(20)\n\nbechdel_20 %>% \n  head(3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 3\n   year title      binary\n  <dbl> <chr>      <chr> \n1  2005 King Kong  FAIL  \n2  1983 Flashdance PASS  \n3  2013 The Purge  FAIL  \n```\n:::\n:::\n\n\nVan de 20 films in deze steekproef slaagden er slechts 9 (45%) voor de test:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbechdel_20 %>% \n  tabyl(binary) %>% \n  adorn_totals(\"row\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n binary  n percent\n   FAIL 11    0.55\n   PASS  9    0.45\n  Total 20    1.00\n```\n:::\n:::\n\n\nDus 9 van $n=20$ geselecteerde films voldoet aan de Bechdel test. De prior van de experts was $2.06,2.98$ en de posterior wordt dan $11.06,23.98$ omdat je aan $\\alpha=2.06$ 9 en aan $\\beta=2.98$ 11 toevoegt. Oftewel:\n\n| Expert    | Prior          | Posterior         |\n|-----------|----------------|-------------------| \n| Totaal    | Beta(2.06,2.98)| Beta(11.06,13.98) |\n\nWe kunnen het ook in een figuur zetten.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_beta_binomial(alpha=2,06, beta=2,98, y=9, n=20) +ggtitle(\"Totaal\")\n```\n\n::: {.cell-output-display}\n![](expertsschattingen_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nDit wordt dan de nieuwe posterior, die een combinatie is van de prior zoals vastgesteld door de experts en de data die we verzameld hebben. Dat figuur ziet er dan zo uit:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_beta(11.06, 13.98) + ggtitle(\"Beta(11.06,13.98),Totaalscore experts en data\")\n```\n\n::: {.cell-output-display}\n![](expertsschattingen_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n## Conclusie\n\nAan de hand van een simpel voorbeeld hebben we laten zien hoe het schattingsproces van een bepaalde uitkomst door experts en onder begeleiding van een facilitator verloopt. Wanneer het moeilijk is om een bepaalde uitkomst te schatten, is dit een goede werkwijze. De uitkomst die dat oplevert kan op zich goed gebruikt worden als schatting. Het is ook mogelijk om deze schatting als prior te gebruiken en te koppelen aan een bepaalde dataset. De combinatie van kennis van experts en inzichten via een verzamelde dataset scherpt onze kennis vervolgens aan. We hebben laten zien hoe dit kan worden uitgevoerd in R.  \n",
    "supporting": [
      "expertsschattingen_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}