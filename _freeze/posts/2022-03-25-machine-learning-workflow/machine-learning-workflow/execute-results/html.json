{
  "hash": "e04d02092bdb1e39cccc25a2b0a12166",
  "result": {
    "markdown": "---\ntitle: \"Machine Learning Workflow\"\ndescription: |\n     Deze blog is een inleiding op de workflow van Machine Learning.\nauthor: \"Harrie Jonkman en Mr.X\"\ndate: \"2022-03-25\"\ncategories: [analyse]\nimage: \"Screenshot.png\"\n---\n\n\n\n# INTRODUCTION\n\n`Tidymodels` is the relatively new package for machine learning with `R`. It is the successor to the `caret` package which is used during the *Introduction to Data Science*-course of the Harvard University (Kuhn & Johnson, 2013; Irizarry, 2020). `Tidymodels` is a collection of modeling packages that, like the `tidyverse`, has consistent API and are designed to work together specifically to support predictive analytics and machine learning. I followed and looked at different books (Kuhn & Silge, 2021; Kuhn en Johnson, 2019) blogs (Lendway, 2020; Roamiar (2021); Ruiz (2019), Barter (2019; Seyedia (2021) and couses/video's (Lewis, 2020; Silge, 2021; Silge 2020). I tried to learn this new system and wrote different blogs in Dutch on this[here](http://www.harriejonkman.nl/HarriesHoekje/).    \n\n`Tidymodels` is a grammar for modeling that makes things a lot easier and provides a unified modeling and analysis interface to seamlessly access several model varities in R. `tidymodels` is a meta-package that installs and load the core packages listed below that you need for modeling and machine learning;   \n- `recipes` is tidy interface for to data pre-processing tools for feature/variables engineering;    \n- `rsample` provides infrastucture for efficient data splitting and resampling;   \n- `parsnip` is a tidy, unified interface to models that can be used to try a range of models without getting bagged down in the syntactical minutae of the underlying packages;   \n- `tune` helps you optimize the hyperparameters of your model and chose pre-processing steps;   \n- `yardstick` measures the effectiveness of models during performance metrics;   \n- `workflow` bundles your pre-processing modeling and post-processing together;   \n- `dials` creates and manages tuning parameters and parameters grids;   \n- `brooms` convert the information in common statistical R objects into user-friendly predictable formats.   \n\nThis year (2021) I learned working with `tidymodels`. I tried to finish the Capstone course with the use of this metapackage. I will show you the different steps in the working proces. \n\nLet us first open the packages used in this article (`tidymodels`, but also `tidyverse`, `finalfit`, `caret`, `rpart` and `randomforest`):\n\n\n\n\n\n\n\n# PROBLEM DEFINITION\n\nData mining approaches are used in this article to predict human wine taste preferences that are based on easily available analytical tests at certification steps. A data set on red wine from Portugal is used here to research quality of the wine and different predictors for the quality (Cortez et al., 2009) Supervised machine learning supports us in this. In this world two kind of algorithms are often used. One is called regression (see also Attalides, 2020) and the other is called classification (not used here). \n\nIn this study we use regression for predicting quality of wine based on several predictors.The wine data used here contains the following eleven independent variables (predictors, I1-I11) and one dependent variable (outcome, D1)\n\nIndependent variables: (symbol I)\n- I1 *Fixed acidity* (g(tartaric acid/dm3)\n- I2 *Volatile acidity* (g(acetic acid)/dm3)\n- I3 *Citric acid* (g/dm3)\n- I4 *Residual sugar* (g/dm3)\n- I5 *Chlorides* (g(sodium chloride)/dm3)\n- I6 *Free sulfar dioxide* (mg/dm3)\n- I7 *Total sulfar dioxide* (mg/dm3)\n- I8 *Density* (g/cm3)\n- I9 *pH*\n- I10 *Sulphates* (g(potassium sulphate)/dm3)\n- I11 *Alcohol* (vol%)\n\nDependent variable: (symbol D)\n- D1 *Quality*\n\n\n# DATA LOADING, PREPROCESSING, EXPLORING\n\nLet us load the data set (`wine.rds`) first.\n\n\n\n\n\nThen, we look at the column names. \n\n\n\n\n\nAnd defined them on a consistent way.\n\n\n\n\n\nLet us make an overview and summary now of this data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(wf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,599\nColumns: 12\n$ fixed_acidity        <dbl> 7.4, 7.8, 7.8, 11.2, 7.4, 7.4, 7.9, 7.3, 7.8, 7.5~\n$ volatile_acidity     <dbl> 0.700, NA, 0.760, 0.280, 0.700, NA, 0.600, 0.650,~\n$ citric_acid          <dbl> 0.00, 0.00, 0.04, 0.56, 0.00, 0.00, 0.06, 0.00, 0~\n$ residual_sugar       <dbl> 1.9, 2.6, 2.3, 1.9, 1.9, 1.8, 1.6, 1.2, 2.0, 6.1,~\n$ chlorides            <dbl> 0.076, 0.098, 0.092, 0.075, 0.076, 0.075, 0.069, ~\n$ free_sulfur_dioxide  <dbl> 11, 25, 15, 17, 11, 13, 15, 15, 9, 17, 15, 17, 16~\n$ total_sulfur_dioxide <dbl> 34, 67, 54, 60, 34, 40, 59, 21, 18, 102, 65, 102,~\n$ density              <dbl> 0.9978, 0.9968, 0.9970, 0.9980, 0.9978, 0.9978, 0~\n$ pH                   <dbl> 3.51, 3.20, 3.26, 3.16, 3.51, 3.51, 3.30, 3.39, 3~\n$ sulphates            <dbl> 0.56, 0.68, 0.65, 0.58, 0.56, 0.56, 0.46, 0.47, 0~\n$ alcohol              <dbl> 9.4, 9.8, 9.8, 9.8, 9.4, 9.4, 9.4, NA, 9.5, 10.5,~\n$ quality              <dbl> 5, 5, 5, 6, 5, 5, 5, 7, 7, 5, 5, 5, 5, 5, 5, 5, 7~\n```\n:::\n\n```{.r .cell-code}\nsummary(wf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n fixed_acidity   volatile_acidity  citric_acid    residual_sugar  \n Min.   : 4.60   Min.   :0.1200   Min.   :0.000   Min.   : 0.900  \n 1st Qu.: 7.10   1st Qu.:0.3900   1st Qu.:0.090   1st Qu.: 1.900  \n Median : 7.90   Median :0.5200   Median :0.260   Median : 2.200  \n Mean   : 8.32   Mean   :0.5275   Mean   :0.271   Mean   : 2.539  \n 3rd Qu.: 9.20   3rd Qu.:0.6400   3rd Qu.:0.420   3rd Qu.: 2.600  \n Max.   :15.90   Max.   :1.5800   Max.   :1.000   Max.   :15.500  \n                 NA's   :3                                        \n   chlorides       free_sulfur_dioxide total_sulfur_dioxide    density      \n Min.   :0.01200   Min.   : 1.00       Min.   :  6.00       Min.   :0.9901  \n 1st Qu.:0.07000   1st Qu.: 7.00       1st Qu.: 22.00       1st Qu.:0.9956  \n Median :0.07900   Median :14.00       Median : 38.00       Median :0.9968  \n Mean   :0.08747   Mean   :15.87       Mean   : 46.47       Mean   :0.9967  \n 3rd Qu.:0.09000   3rd Qu.:21.00       3rd Qu.: 62.00       3rd Qu.:0.9978  \n Max.   :0.61100   Max.   :72.00       Max.   :289.00       Max.   :1.0037  \n                                                                            \n       pH          sulphates         alcohol         quality     \n Min.   :2.740   Min.   :0.3300   Min.   : 8.40   Min.   :3.000  \n 1st Qu.:3.210   1st Qu.:0.5500   1st Qu.: 9.50   1st Qu.:5.000  \n Median :3.310   Median :0.6200   Median :10.20   Median :6.000  \n Mean   :3.311   Mean   :0.6581   Mean   :10.43   Mean   :5.636  \n 3rd Qu.:3.400   3rd Qu.:0.7300   3rd Qu.:11.10   3rd Qu.:6.000  \n Max.   :4.010   Max.   :2.0000   Max.   :14.90   Max.   :8.000  \n                                  NA's   :5                      \n```\n:::\n:::\n\n\nWe have twelve variables inside this data set which are all continuous variables.\n\nAt this moment we want to know also something about the missings?\n\n\n\n\n\nWe have eight missings (three on volatile.acidity and five on alcohol). We remove any missing values and kept 1591 cases. Let us show it here.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwf <- na.omit(wf)\n\nmissing_glimpse(wf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                    label var_type    n missing_n\nfixed_acidity               fixed_acidity    <dbl> 1591         0\nvolatile_acidity         volatile_acidity    <dbl> 1591         0\ncitric_acid                   citric_acid    <dbl> 1591         0\nresidual_sugar             residual_sugar    <dbl> 1591         0\nchlorides                       chlorides    <dbl> 1591         0\nfree_sulfur_dioxide   free_sulfur_dioxide    <dbl> 1591         0\ntotal_sulfur_dioxide total_sulfur_dioxide    <dbl> 1591         0\ndensity                           density    <dbl> 1591         0\npH                                     pH    <dbl> 1591         0\nsulphates                       sulphates    <dbl> 1591         0\nalcohol                           alcohol    <dbl> 1591         0\nquality                           quality    <dbl> 1591         0\n                     missing_percent\nfixed_acidity                    0.0\nvolatile_acidity                 0.0\ncitric_acid                      0.0\nresidual_sugar                   0.0\nchlorides                        0.0\nfree_sulfur_dioxide              0.0\ntotal_sulfur_dioxide             0.0\ndensity                          0.0\npH                               0.0\nsulphates                        0.0\nalcohol                          0.0\nquality                          0.0\n```\n:::\n:::\n\n\nNow we have wrangeled and preprocessed the data, we can explore them. Let us first vizualise correlations within the data-set. For this you need the package `corrplot`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwf %>% cor() %>% \n  corrplot.mixed(upper = \"circle\",\n                 tl.cex = 1,\n                 tl.pos = 'lt',\n                 number.cex = 0.75)\n```\n\n::: {.cell-output-display}\n![](machine-learning-workflow_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n## SPLITTING THE DATA\n\nNow we understand the data we have to split the data into: a) Train set, b) Test set. Here we work on the last pre-model analysis. All functions below come from the `rsample` package, which is part of `tidymodels`. First we set the seed to fix the randomization and to make reproducabiltiy possible. We use 80% of the dataset for the trainingset. For a big dataset as this wine-data set with 1591 observations, 80:20-splitting works well. We split it and than make a training- and test-dataset.\n\n\n\n\n\n\n# MODELING AND DATA ANALYSIS \n\nNow we will compare different models with each other and want to know which one works the best for this data set with this dependent and these independent variables. This part of machine learning is called **supervised learning** of which the basic goal is to find a function that accurately describes how different measured explanatory variables can be combined to make a prediction about the target variable. We start with **linear modelling**. Regression models can help us quantify the magnitude and direction of relationships among variables.\n\n## 1. Linear modelling\nFor the outcome or target variable `quality`, we first research some different linear regression models and choose the best one based on indices. For these tasks, we store each formula in a different R object.\n\nWe have to define the data: \n- The target variable. `quality` is the target variable and it is numeric\n- The features of the model (predictors) are the other (independent) variables here and they are numeric variables also.\n\nFuthermore, we design a simple formula to predict the target variable. In this formula (f1) all the available 11 predictors are used.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformula <- formula(quality ~ fixed_acidity + volatile_acidity + citric_acid + \n                   residual_sugar + chlorides + free_sulfur_dioxide + \n                   total_sulfur_dioxide + density + pH + sulphates + alcohol)\n```\n:::\n\n\n\nLet us fit a linear regression model to the data. What we do:\n- First, we created an object that will store the model fit.    \n- Then, we specify the model.   \n- Then, We specify also that we work with regression because of the continue target variable (`quality`).\n- Then, we specify also the `lm` package to train the model.\n- And we finish in this chunck by adding the formula and the training data to fit the model.\n\nLet us see how this workflow works.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_fit <- \n  linear_reg() %>% \n  set_mode(\"regression\") %>% \n  set_engine(\"lm\") %>% \n  fit(formula, data = train_data) \n```\n:::\n\n\nWe present the results on different ways \n\n\n\n\n\nBut this is probably the best and clearest way to show the results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm_fit$fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nstats::lm(formula = quality ~ fixed_acidity + volatile_acidity + \n    citric_acid + residual_sugar + chlorides + free_sulfur_dioxide + \n    total_sulfur_dioxide + density + pH + sulphates + alcohol, \n    data = data)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.68924 -0.37784 -0.04982  0.46247  1.89438 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(>|t|)    \n(Intercept)           2.125e+01  2.458e+01   0.864   0.3877    \nfixed_acidity         1.515e-02  3.015e-02   0.503   0.6154    \nvolatile_acidity     -9.626e-01  1.419e-01  -6.783 1.80e-11 ***\ncitric_acid          -1.749e-02  1.682e-01  -0.104   0.9172    \nresidual_sugar        1.879e-02  1.750e-02   1.074   0.2831    \nchlorides            -2.160e+00  4.601e-01  -4.696 2.95e-06 ***\nfree_sulfur_dioxide   5.057e-03  2.477e-03   2.042   0.0414 *  \ntotal_sulfur_dioxide -4.053e-03  8.358e-04  -4.850 1.39e-06 ***\ndensity              -1.685e+01  2.511e+01  -0.671   0.5022    \npH                   -4.781e-01  2.216e-01  -2.157   0.0312 *  \nsulphates             9.522e-01  1.256e-01   7.581 6.63e-14 ***\nalcohol               2.675e-01  3.070e-02   8.712  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.6545 on 1260 degrees of freedom\nMultiple R-squared:  0.3583,\tAdjusted R-squared:  0.3527 \nF-statistic: 63.96 on 11 and 1260 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nWe can also visualize the fit summary by using the `broom` package which is inside `tidymodels`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(lm_fit$fit) %>% mutate_if(is.numeric, round, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 x 5\n   term                 estimate std.error statistic p.value\n   <chr>                   <dbl>     <dbl>     <dbl>   <dbl>\n 1 (Intercept)            21.2      24.6       0.864   0.388\n 2 fixed_acidity           0.015     0.03      0.503   0.615\n 3 volatile_acidity       -0.963     0.142    -6.78    0    \n 4 citric_acid            -0.017     0.168    -0.104   0.917\n 5 residual_sugar          0.019     0.018     1.07    0.283\n 6 chlorides              -2.16      0.46     -4.70    0    \n 7 free_sulfur_dioxide     0.005     0.002     2.04    0.041\n 8 total_sulfur_dioxide   -0.004     0.001    -4.85    0    \n 9 density               -16.9      25.1      -0.671   0.502\n10 pH                     -0.478     0.222    -2.16    0.031\n11 sulphates               0.952     0.126     7.58    0    \n12 alcohol                 0.267     0.031     8.71    0    \n```\n:::\n:::\n\n\n\n## 2. Decision tree\nAfter we worked with linear regression, it is possible to work with other models which maybe give us better results for predicting the outcome. Let us first look at decision tree modeling. A decision tree is tree-like flowchart that assigns labels to individual observations. It splits it into homogeneous subsets, which share the same class labels. For this you need decision tree package and for this you have to install and open the library of `rpart`. We see similar steps here in the machine learning workflow. \nOnce again, the workflow:\n- define an object `dt_fit`;   \n- tell that we work with decision tree;   \n- set the mode on regression;   \n- set the engine on `rpart`;   \n- fit the formula on the training data-set.   \n\n\n\n\n\nPrint the results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(dt_fit$fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nn= 1272 \n\nnode), split, n, deviance, yval\n      * denotes terminal node\n\n 1) root 1272 841.093600 5.645440  \n   2) alcohol< 10.45 735 314.223100 5.345578  \n     4) sulphates< 0.585 323  99.275540 5.133127 *\n     5) sulphates>=0.585 412 188.939300 5.512136  \n      10) total_sulfur_dioxide>=59.5 121  33.239670 5.198347 *\n      11) total_sulfur_dioxide< 59.5 291 138.831600 5.642612  \n        22) volatile_acidity>=0.405 220  94.836360 5.527273 *\n        23) volatile_acidity< 0.405 71  32.000000 6.000000 *\n   3) alcohol>=10.45 537 370.324000 6.055866  \n     6) sulphates< 0.645 240 156.733300 5.716667  \n      12) volatile_acidity>=0.995 7   6.857143 4.142857 *\n      13) volatile_acidity< 0.995 233 132.017200 5.763948  \n        26) pH>=3.365 114  62.280700 5.543860  \n          52) free_sulfur_dioxide< 8.5 34  19.529410 5.117647 *\n          53) free_sulfur_dioxide>=8.5 80  33.950000 5.725000 *\n        27) pH< 3.365 119  58.924370 5.974790 *\n     7) sulphates>=0.645 297 163.663300 6.329966  \n      14) alcohol< 11.45 180  95.777780 6.111111  \n        28) volatile_acidity>=0.405 94  35.276600 5.829787 *\n        29) volatile_acidity< 0.405 86  44.930230 6.418605  \n          58) total_sulfur_dioxide>=49.5 20   8.550000 5.850000 *\n          59) total_sulfur_dioxide< 49.5 66  27.954550 6.590909 *\n      15) alcohol>=11.45 117  46.000000 6.666667 *\n```\n:::\n:::\n\n\nAs a sidestep, we can visualize this, but than we have to install and open the `visNetwork` and `sparkline` packages. Then we see this.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(visNetwork)\nlibrary(sparkline)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'sparkline' was built under R version 4.1.3\n```\n:::\n\n```{.r .cell-code}\nvisTree(dt_fit$fit)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-77bbd082f7512b02772a\" style=\"width:100%;height:600px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-77bbd082f7512b02772a\">{\"x\":{\"nodes\":{\"id\":[1,2,4,5,10,11,22,23,3,6,12,13,26,52,53,27,7,14,28,29,58,59,15],\"label\":[\"alcohol\",\"sulphates\",\"5.133\",\"total_sulfur_dioxide\",\"5.198\",\"volatile_acidity\",\"5.527\",\"6\",\"sulphates\",\"volatile_acidity\",\"4.143\",\"pH\",\"free_sulfur_dioxide\",\"5.118\",\"5.725\",\"5.975\",\"alcohol\",\"volatile_acidity\",\"5.83\",\"total_sulfur_dioxide\",\"5.85\",\"6.591\",\"6.667\"],\"level\":[1,2,3,3,4,4,5,5,2,3,4,4,5,6,6,5,3,4,5,5,6,6,4],\"color\":[\"#F1B8C2\",\"#E1C1A1\",\"#C189DC\",\"#BECC9B\",\"#BF83DA\",\"#96D4B5\",\"#B267D1\",\"#A13EC3\",\"#E1C1A1\",\"#96D4B5\",\"#E6E0F8\",\"#8DD2D8\",\"#B4C7ED\",\"#C28BDC\",\"#AB56CB\",\"#A240C4\",\"#F1B8C2\",\"#96D4B5\",\"#A74CC8\",\"#BECC9B\",\"#A74BC7\",\"#8B0AB3\",\"#8904B1\"],\"value\":[1272,735,323,412,121,291,220,71,537,240,7,233,114,34,80,119,297,180,94,86,20,66,117],\"shape\":[\"dot\",\"dot\",\"square\",\"dot\",\"square\",\"dot\",\"square\",\"square\",\"dot\",\"dot\",\"square\",\"dot\",\"dot\",\"square\",\"square\",\"square\",\"dot\",\"dot\",\"square\",\"dot\",\"square\",\"square\",\"square\"],\"title\":[\"<div style=\\\"text-align:center;\\\">N : <b>100%<\\/b> (1272)<br>Complexity : <b>0.186<\\/b><br>Mean : <b>5.645<\\/b><br>Variance : <b>0.662<\\/b><\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>57.8%<\\/b> (735)<br>Complexity : <b>0.031<\\/b><br>Mean : <b>5.346<\\/b><br>Variance : <b>0.428<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> < 10.45<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>25.4%<\\/b> (323)<br>Complexity : <b>0.005<\\/b><br>Mean : <b>5.133<\\/b><br>Variance : <b>0.308<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> < 10.45<br><b> sulphates <\\/b> < 0.585<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>32.4%<\\/b> (412)<br>Complexity : <b>0.02<\\/b><br>Mean : <b>5.512<\\/b><br>Variance : <b>0.46<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> < 10.45<br><b> sulphates <\\/b> >= 0.585<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>9.5%<\\/b> (121)<br>Complexity : <b>0.005<\\/b><br>Mean : <b>5.198<\\/b><br>Variance : <b>0.277<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> < 10.45<br><b> sulphates <\\/b> >= 0.585<br><b> total_sulfur_dioxide <\\/b> >= 59.5<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>22.9%<\\/b> (291)<br>Complexity : <b>0.014<\\/b><br>Mean : <b>5.643<\\/b><br>Variance : <b>0.479<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> < 10.45<br><b> sulphates <\\/b> >= 0.585<br><b> total_sulfur_dioxide <\\/b> < 59.5<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>17.3%<\\/b> (220)<br>Complexity : <b>0.007<\\/b><br>Mean : <b>5.527<\\/b><br>Variance : <b>0.433<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> < 10.45<br><b> sulphates <\\/b> >= 0.585<br><b> total_sulfur_dioxide <\\/b> < 59.5<br><b> volatile_acidity <\\/b> >= 0.405<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>5.6%<\\/b> (71)<br>Complexity : <b>0.005<\\/b><br>Mean : <b>6<\\/b><br>Variance : <b>0.457<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> < 10.45<br><b> sulphates <\\/b> >= 0.585<br><b> total_sulfur_dioxide <\\/b> < 59.5<br><b> volatile_acidity <\\/b> < 0.405<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>42.2%<\\/b> (537)<br>Complexity : <b>0.059<\\/b><br>Mean : <b>6.056<\\/b><br>Variance : <b>0.691<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> >= 10.45<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>18.9%<\\/b> (240)<br>Complexity : <b>0.021<\\/b><br>Mean : <b>5.717<\\/b><br>Variance : <b>0.656<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> >= 10.45<br><b> sulphates <\\/b> < 0.645<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>0.6%<\\/b> (7)<br>Complexity : <b>0.01<\\/b><br>Mean : <b>4.143<\\/b><br>Variance : <b>1.143<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> >= 10.45<br><b> sulphates <\\/b> < 0.645<br><b> volatile_acidity <\\/b> >= 0.995<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>18.3%<\\/b> (233)<br>Complexity : <b>0.013<\\/b><br>Mean : <b>5.764<\\/b><br>Variance : <b>0.569<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> >= 10.45<br><b> sulphates <\\/b> < 0.645<br><b> volatile_acidity <\\/b> < 0.995<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>9%<\\/b> (114)<br>Complexity : <b>0.01<\\/b><br>Mean : <b>5.544<\\/b><br>Variance : <b>0.551<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> >= 10.45<br><b> sulphates <\\/b> < 0.645<br><b> volatile_acidity <\\/b> < 0.995<br><b> pH <\\/b> >= 3.365<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>2.7%<\\/b> (34)<br>Complexity : <b>0.003<\\/b><br>Mean : <b>5.118<\\/b><br>Variance : <b>0.592<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> >= 10.45<br><b> sulphates <\\/b> < 0.645<br><b> volatile_acidity <\\/b> < 0.995<br><b> pH <\\/b> >= 3.365<br><b> free_sulfur_dioxide <\\/b> < 8.5<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>6.3%<\\/b> (80)<br>Complexity : <b>0.005<\\/b><br>Mean : <b>5.725<\\/b><br>Variance : <b>0.43<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> >= 10.45<br><b> sulphates <\\/b> < 0.645<br><b> volatile_acidity <\\/b> < 0.995<br><b> pH <\\/b> >= 3.365<br><b> free_sulfur_dioxide <\\/b> >= 8.5<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>9.4%<\\/b> (119)<br>Complexity : <b>0.01<\\/b><br>Mean : <b>5.975<\\/b><br>Variance : <b>0.499<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> >= 10.45<br><b> sulphates <\\/b> < 0.645<br><b> volatile_acidity <\\/b> < 0.995<br><b> pH <\\/b> < 3.365<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>23.3%<\\/b> (297)<br>Complexity : <b>0.026<\\/b><br>Mean : <b>6.33<\\/b><br>Variance : <b>0.553<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> >= 10.45<br><b> sulphates <\\/b> >= 0.645<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>14.2%<\\/b> (180)<br>Complexity : <b>0.019<\\/b><br>Mean : <b>6.111<\\/b><br>Variance : <b>0.535<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b>  <\\/b> 10.45 <= <b>alcohol<\\/b> < 11.45<br><b> sulphates <\\/b> >= 0.645<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>7.4%<\\/b> (94)<br>Complexity : <b>0.006<\\/b><br>Mean : <b>5.83<\\/b><br>Variance : <b>0.379<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b>  <\\/b> 10.45 <= <b>alcohol<\\/b> < 11.45<br><b> sulphates <\\/b> >= 0.645<br><b> volatile_acidity <\\/b> >= 0.405<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>6.8%<\\/b> (86)<br>Complexity : <b>0.01<\\/b><br>Mean : <b>6.419<\\/b><br>Variance : <b>0.529<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b>  <\\/b> 10.45 <= <b>alcohol<\\/b> < 11.45<br><b> sulphates <\\/b> >= 0.645<br><b> volatile_acidity <\\/b> < 0.405<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>1.6%<\\/b> (20)<br>Complexity : <b>0.004<\\/b><br>Mean : <b>5.85<\\/b><br>Variance : <b>0.45<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b>  <\\/b> 10.45 <= <b>alcohol<\\/b> < 11.45<br><b> sulphates <\\/b> >= 0.645<br><b> volatile_acidity <\\/b> < 0.405<br><b> total_sulfur_dioxide <\\/b> >= 49.5<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>5.2%<\\/b> (66)<br>Complexity : <b>0.002<\\/b><br>Mean : <b>6.591<\\/b><br>Variance : <b>0.43<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b>  <\\/b> 10.45 <= <b>alcohol<\\/b> < 11.45<br><b> sulphates <\\/b> >= 0.645<br><b> volatile_acidity <\\/b> < 0.405<br><b> total_sulfur_dioxide <\\/b> < 49.5<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\",\"<div style=\\\"text-align:center;\\\">N : <b>9.2%<\\/b> (117)<br>Complexity : <b>0.008<\\/b><br>Mean : <b>6.667<\\/b><br>Variance : <b>0.397<\\/b><hr class = \\\"rPartvisNetwork\\\">\\n<div class =\\\"showOnMe2\\\"><div style=\\\"text-align:center;\\\"><U style=\\\"color:blue;\\\"  onmouseover=\\\"this.style.cursor='pointer';\\\" onmouseout=\\\"this.style.cursor='default';\\\">Rules<\\/U><\\/div>\\n<div class=\\\"showMeRpartTTp2\\\" style=\\\"display:none;\\\">\\n<b> alcohol <\\/b> >= 11.45<br><b> sulphates <\\/b> >= 0.645<\\/script><script type=\\\"text/javascript\\\">$(document).ready(function(){\\n$(\\\".showOnMe2\\\").click(function(){\\n$(\\\".showMeRpartTTp2\\\").toggle();\\n$.sparkline_display_visible();\\n});\\n  });<\\/script><\\/div><\\/div>\\n\\n<\\/div>\"],\"fixed\":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],\"colorClust\":[\"#AE5DCD\",\"#B977D6\",\"#C189DC\",\"#B368D1\",\"#BF83DA\",\"#AE5DCD\",\"#B267D1\",\"#A13EC3\",\"#9F39C2\",\"#AC56CB\",\"#E6E0F8\",\"#AA52CA\",\"#B265D0\",\"#C28BDC\",\"#AB56CB\",\"#A240C4\",\"#9521BA\",\"#9D34C0\",\"#A74CC8\",\"#9219B7\",\"#A74BC7\",\"#8B0AB3\",\"#8904B1\"],\"labelClust\":[5.645,5.346,5.133,5.512,5.198,5.643,5.527,6,6.056,5.717,4.143,5.764,5.544,5.118,5.725,5.975,6.33,6.111,5.83,6.419,5.85,6.591,6.667],\"Leaf\":[0,0,1,0,1,0,1,1,0,0,1,0,0,1,1,1,0,0,1,0,1,1,1],\"font.size\":[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],\"scaling.min\":[22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5],\"scaling.max\":[22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5,22.5]},\"edges\":{\"id\":[\"edge1\",\"edge2\",\"edge3\",\"edge4\",\"edge5\",\"edge6\",\"edge7\",\"edge8\",\"edge9\",\"edge10\",\"edge11\",\"edge12\",\"edge13\",\"edge14\",\"edge15\",\"edge16\",\"edge17\",\"edge18\",\"edge19\",\"edge20\",\"edge21\",\"edge22\"],\"from\":[1,2,2,5,5,11,11,1,3,6,6,13,26,26,13,3,7,14,14,29,29,7],\"to\":[2,4,5,10,11,22,23,3,6,12,13,26,52,53,27,7,14,28,29,58,59,15],\"label\":[\"< 10.45\",\"< 0.585\",\">= 0.585\",\">= 59.5\",\"< 59.5\",\">= 0.405\",\"< 0.405\",\">= 10.45\",\"< 0.645\",\">= 0.995\",\"< 0.995\",\">= 3.365\",\"< 8.5\",\">= 8.5\",\"< 3.365\",\">= 0.645\",\"< 11.45\",\">= 0.405\",\"< 0.405\",\">= 49.5\",\"< 49.5\",\">= 11.45\"],\"value\":[735,323,412,121,291,220,71,537,240,7,233,114,34,80,119,297,180,94,86,20,66,117],\"title\":[\"<div style=\\\"text-align:center;\\\"><b>alcohol<\\/b><\\/div><div style=\\\"text-align:center;\\\"><10.45<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>sulphates<\\/b><\\/div><div style=\\\"text-align:center;\\\"><0.585<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>sulphates<\\/b><\\/div><div style=\\\"text-align:center;\\\">>=0.585<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>total_sulfur_dioxide<\\/b><\\/div><div style=\\\"text-align:center;\\\">>=59.5<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>total_sulfur_dioxide<\\/b><\\/div><div style=\\\"text-align:center;\\\"><59.5<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>volatile_acidity<\\/b><\\/div><div style=\\\"text-align:center;\\\">>=0.405<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>volatile_acidity<\\/b><\\/div><div style=\\\"text-align:center;\\\"><0.405<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>alcohol<\\/b><\\/div><div style=\\\"text-align:center;\\\">>=10.45<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>sulphates<\\/b><\\/div><div style=\\\"text-align:center;\\\"><0.645<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>volatile_acidity<\\/b><\\/div><div style=\\\"text-align:center;\\\">>=0.995<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>volatile_acidity<\\/b><\\/div><div style=\\\"text-align:center;\\\"><0.995<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>pH<\\/b><\\/div><div style=\\\"text-align:center;\\\">>=3.365<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>free_sulfur_dioxide<\\/b><\\/div><div style=\\\"text-align:center;\\\"><8.5<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>free_sulfur_dioxide<\\/b><\\/div><div style=\\\"text-align:center;\\\">>=8.5<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>pH<\\/b><\\/div><div style=\\\"text-align:center;\\\"><3.365<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>sulphates<\\/b><\\/div><div style=\\\"text-align:center;\\\">>=0.645<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>alcohol<\\/b><\\/div><div style=\\\"text-align:center;\\\"><11.45<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>volatile_acidity<\\/b><\\/div><div style=\\\"text-align:center;\\\">>=0.405<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>volatile_acidity<\\/b><\\/div><div style=\\\"text-align:center;\\\"><0.405<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>total_sulfur_dioxide<\\/b><\\/div><div style=\\\"text-align:center;\\\">>=49.5<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>total_sulfur_dioxide<\\/b><\\/div><div style=\\\"text-align:center;\\\"><49.5<\\/div>\",\"<div style=\\\"text-align:center;\\\"><b>alcohol<\\/b><\\/div><div style=\\\"text-align:center;\\\">>=11.45<\\/div>\"],\"color\":[\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\",\"#8181F7\"],\"font.size\":[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14],\"font.align\":[\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\",\"horizontal\"],\"smooth.enabled\":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],\"smooth.type\":[\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\",\"cubicBezier\"],\"smooth.roundness\":[0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\"},\"manipulation\":{\"enabled\":false},\"layout\":{\"hierarchical\":{\"enabled\":true,\"direction\":\"UD\"}},\"interaction\":{\"dragNodes\":false,\"selectConnectedEdges\":false,\"tooltipDelay\":500,\"zoomSpeed\":1},\"edges\":{\"scaling\":{\"label\":{\"enabled\":false}}}},\"groups\":null,\"width\":\"100%\",\"height\":\"600px\",\"idselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;\"},\"submain\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-size:12px;text-align:center;\"},\"footer\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-size:12px;text-align:center;\"},\"background\":\"rgba(0, 0, 0, 0)\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":{\"from\":50000,\"to\":0},\"algorithm\":\"hierarchical\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":true,\"fit\":true,\"resetHighlight\":true,\"clusterOptions\":{\"fixed\":true,\"physics\":false},\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;\\n                      white-space: nowrap;\\n                      font-family: cursive;font-size:12px;font-color:purple;background-color: #E6E6E6;\\n                      border-radius: 15px;\",\"OnceEvents\":{\"stabilized\":\"function() { \\n        this.setOptions({layout:{hierarchical:false}, physics:{solver:'barnesHut', enabled:true, stabilization : false}, nodes : {physics : false, fixed : true}});\\n    }\"},\"legend\":{\"width\":0.1,\"useGroups\":false,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"nodes\":{\"label\":[\"alcohol\",\"free_sulfur_dioxide\",\"pH\",\"sulphates\",\"total_sulfur_dioxide\",\"volatile_acidity\"],\"color\":[\"#F1B8C2\",\"#B4C7ED\",\"#8DD2D8\",\"#E1C1A1\",\"#BECC9B\",\"#96D4B5\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\"],\"size\":[22,22,22,22,22,22],\"Leaf\":[0,0,0,0,0,0],\"font.size\":[16,16,16,16,16,16],\"id\":[10000,10001,10002,10003,10004,10005]},\"nodesToDataframe\":true},\"tree\":{\"updateShape\":true,\"shapeVar\":\"dot\",\"shapeY\":\"square\",\"colorVar\":{\"variable\":[\"alcohol\",\"sulphates\",\"total_sulfur_dioxide\",\"volatile_acidity\",\"pH\",\"free_sulfur_dioxide\"],\"color\":[\"#F1B8C2\",\"#E1C1A1\",\"#BECC9B\",\"#96D4B5\",\"#8DD2D8\",\"#B4C7ED\"]},\"colorY\":{\"colRamp\":[\"function (x) \",\"roundcolor(cbind(palette[[1L]](x), palette[[2L]](x), palette[[3L]](x), \",\"    if (alpha) palette[[4L]](x))) * 255\"],\"colorTerm\":[\"#AE5DCD\",\"#B977D6\",\"#C189DC\",\"#B368D1\",\"#BF83DA\",\"#AE5DCD\",\"#B267D1\",\"#A13EC3\",\"#9F39C2\",\"#AC56CB\",\"#E6E0F8\",\"#AA52CA\",\"#B265D0\",\"#C28BDC\",\"#AB56CB\",\"#A240C4\",\"#9521BA\",\"#9D34C0\",\"#A74CC8\",\"#9219B7\",\"#A74BC7\",\"#8B0AB3\",\"#8904B1\"],\"colorY\":[\"#E6E0F8\",\"#8904B1\"],\"vardecidedClust\":[5.645,5.346,5.133,5.512,5.198,5.643,5.527,6,6.056,5.717,4.143,5.764,5.544,5.118,5.725,5.975,6.33,6.111,5.83,6.419,5.85,6.591,6.667]}},\"export\":{\"type\":\"png\",\"css\":\"float:right;-webkit-border-radius: 10;\\n                  -moz-border-radius: 10;\\n                  border-radius: 10px;\\n                  font-family: Arial;\\n                  color: #ffffff;\\n                  font-size: 12px;\\n                  background: #090a0a;\\n                  padding: 4px 8px 4px 4px;\\n                  text-decoration: none;\",\"background\":\"#fff\",\"name\":\"network.png\",\"label\":\"Export as png\"}},\"evals\":[\"OnceEvents.stabilized\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## 3. Random forest\nA third model we use here is RandomForest. RandomForest is a natural extension of DecisionTree. A RandomForest is a collection of Deciontrees that are aggregated by majority rule, and is in essence a collection 'bootstrapped' decision trees. You need to install `randomForest` package and open the library `randomForest`. \nAnd also here, once again the same steps:\n- define object `rf_fit`;    \n- tell we want to use randomforest;    \n- set the mode again on regression;      \n- set the engine here on randomForest;    \n- fit the model on the training_set.   \n\n\n\n\n\nPrint these results (not shown here).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(rf_fit$fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\n randomForest(x = maybe_data_frame(x), y = y) \n               Type of random forest: regression\n                     Number of trees: 500\nNo. of variables tried at each split: 3\n\n          Mean of squared residuals: 0.3259127\n                    % Var explained: 50.71\n```\n:::\n:::\n\n\n\n# EVALUATION AND PREDICTION\n\nNow we have three objects of the three models we ran and which we have to compare and evaluate. We do this on the test-set. We compare the three models (`lm_fit`, `dt_fit` and `rf_fit`) on the Men Square Score (MSE) score. We need to find a model algorithm that produces predictors for the outcome (`quality`) that minimizes the MSE-score. So, the lower the mse-score of the model, the better.\n\n\n## 1. Accuracy of the lm-model\n\nLet us first look at the accuracy of the linear-model.\n\n\n\n\n\nNow we see a new column, `.pred`, with a predicted scores for each row. \n\n\n\n\n\n\n\n\n\nIt gives here the following mse-score for linear modeling, which we show here.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(lm_mse)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 x 2\n  type    MSE\n  <chr> <dbl>\n1 lm    0.467\n```\n:::\n:::\n\n\n\n## 2. Accuracy of the Decision Tree Model\nThen we look at the accuracy of the DecisionTree Model.\n\n\n\n\n\n\n\nThe decision model gives the following mse-score.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(dt_mse)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 x 2\n  type    MSE\n  <chr> <dbl>\n1 dt    0.596\n```\n:::\n:::\n\n\n\n## 3. Accuracy of the Random Forest Model\nAnd then ofcourse we also have to look at the accuracy of the RandomForest-model. \n\n\n\n\n\n\n\nThe Random Forest Model gives us the following mse-score:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(rf_mse)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 x 2\n  type    MSE\n  <chr> <dbl>\n1 rf    0.408\n```\n:::\n:::\n\n\n\n## All results together\n\nLet us put all the results together and compare them with each other.\n\n\n\n\n\nLet us show these results together.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(res)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 x 2\n  type    MSE\n  <chr> <dbl>\n1 lm    0.467\n2 dt    0.596\n3 rf    0.408\n```\n:::\n:::\n\nAltogether the prediction scores don't look very well, but we know that RandomForest is the best model for prediction.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmetrics(rf_pred, quality, pred)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 x 3\n  .metric .estimator .estimate\n  <chr>   <chr>          <dbl>\n1 rmse    standard       0.638\n2 rsq     standard       0.378\n3 mae     standard       0.351\n```\n:::\n:::\n\n\nNow we choosed the random forest model, we can look at the importance of the ten independent variables and compare them with each other. We see that alcohol is the most import predictor for quality followed by sulphates ad volatile_acidity. Residul-sugar, pH and fixed_acidity are the lowest important predictors for quality of wine.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(vip)\nvip(rf_fit)\n```\n\n::: {.cell-output-display}\n![](machine-learning-workflow_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\nLet us look at which percentage of the test sample are wrongly predicted.\n\n\n\n\n\n$105/307*100= 34,2%$ is not correctly predicted. So $65,8%$ is predicted correctly with this model. We choose the random_forest model as the best opportunity here. Let us look at it once again.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(rf_pred)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 x 13\n  fixed_~1 volat~2 citri~3 resid~4 chlor~5 free_~6 total~7 density    pH sulph~8\n     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <dbl>   <dbl>\n1     11.2    0.28    0.56     1.9   0.075      17      60   0.998  3.16    0.58\n2      7.5    0.5     0.36     6.1   0.071      17     102   0.998  3.35    0.8 \n3      8.9    0.62    0.18     3.8   0.176      52     145   0.999  3.16    0.88\n4      8.9    0.22    0.48     1.8   0.077      29      60   0.997  3.39    0.53\n5      7.9    0.43    0.21     1.6   0.106      10      37   0.997  3.17    0.91\n6      7.1    0.71    0        1.9   0.08       14      35   0.997  3.47    0.55\n# ... with 3 more variables: alcohol <dbl>, quality <dbl>, pred <dbl>, and\n#   abbreviated variable names 1: fixed_acidity, 2: volatile_acidity,\n#   3: citric_acid, 4: residual_sugar, 5: chlorides, 6: free_sulfur_dioxide,\n#   7: total_sulfur_dioxide, 8: sulphates\n```\n:::\n:::\n\n\n\n# CONCLUSION\n\nIn this simple scenario, we were interested in seeing how the model performs on the testing data that were left out. The code fitted the model to the training data and apply it to the testing data. There are other ways we could have done this, but the way we do it here will be useful when we start using more complex models where we need to tune model parameters. Root Mean Square Error (RMSE) is a standard way to measure the error of a model in predicting quantitative data. RMSE is a good measure to use if we want to estimate the standard deviation of a typical observed value from our model’s prediction, R-squared is a statistical measure that represents the goodness of fit of a regression model. The ideal value for r-square is 1. The closer the value of r-square to 1, the better is the model fitted. In Machine Learning, MAE is a model evaluation metric often used with regression models. After the model is fitted and applied, we collected the performance metrics and display them and show the predictions from the testing data.  34,2% is predicted wrong, which is at the end maybe a bit disappointing after all the work. But we know what the best model is for this data-set.    \nThis work has some **strengths** We found a uniform and consistent way to compare models with each and to choose the best one out of them. One of the big advantages of the random forest model (which is choosen here) is the versality and flexibility. It can be used for both regression and classification problems. But this work has also some **limitations**. Random forest is good for predictions and regression, so this could be used by the researcher for interpretation here. But for of modelling is relatively new for this researcher (instead of linear regression for example) so he found himself restricted here at the end. A limitation of random forest is also that this algorithm is fast to train, but quit slow to create predictions once they are trained: a more accurate prediction needs more trees, which results in a slower model. And a last limitation which we have to mention here is, that we used only three models and maybe other models were better for these data. \n\nLesson learned is that we found a consitent workflow for analyzing data as presented here on quality of wine. It is a very good starting point for further research. The next step would be now to work on increasing the predictive power of the model and start with tuning on the hyperparameters. \n\n\n# References\n\nAttalides, N. (2020). [Introduction to machine learning. Barcelona. Presentation](https://www.barcelonar.org/workshops/BarcelonaR_Introduction_to_Machine_Learning.pdf) \n\nBarter, R.(2020). [Tidymodels: tidy machine learning in R](http://www.rebeccabarter.com/blog/2020-03-25_machine_learning/) \n\nBaumer, B. Kaplan, D.T., Horton, N.J. (2017). *Modern data science with R*. CRCPress: Boca Raton.\n\nBoehmke, B. & Greenwell, B. (2020). *Hands on machine learning with R*. [Bookdown version](https://bradleyboehmke.github.io/HOML)\n\nCortez, P., Cerdeira, A., Almeida, F., Matos, T. & Reis, J. (2009). Modeling wine prefernces by data mining from physicochemical properties. *Decision Support Systems, 47*, 547-533. \n\nHartie, T., Tibskirani, R. & Friedmann, J. (2009). *The elements of statistical learning. Data mining, inference and prediction*. 2nd edition. Springer: New York.\n\nIrizarry, R.A. (2020). *Introduction to data science. Data analysis and prediction algorithms with R*. CRC Press: Boca Raton.\n\nJames, S., Witten, D., Hastie, T.. & Tibskirani, R. (2013). *An introduction to statistical learning with application in R*. \n\nJonkman, H. (2019-2021). [Harrie's hoekje, his website with different blogs on machine learning in Dutch](http://www.harriejonkman.nl/HarriesHoekje/) \n\nKuhn, M. 7 Johnson, K. (2013). *Applied predictive modeling*. Springer: New York.\n\nKuhn, M. & Johnson, K. (2019). [Feature engineering and selection: A practical approach for predictive models](www.feat.engineering)\n\nKuhn, M. & Silge, J. (2021). Tydy modeling with R. [Bookdown version](https://www.tmwr.org/)\n\nLendway, L. (2020). 2020_north-tidymodels.[Introduction on github](https://github.com/llendway/2020_north_tidymodels)\n\nLewis, J.E. (2020). [Coding machine learning models](https://www.youtube.com/watch?v=WlL44_is4TU)\n\nRaoniar, R. (2021). Modeling binary logistic regression using tidymodels library in R (Part 1). [Towards data science](https://towardsdatascience.com/modelling-binary-logistic-regression-using-tidymodels-library-in-r-part-1-c1bdce0ac055)\n\nRuiz, E. (2019). [A gentle introduction to tidymodels](https://rviews.rstudio.com/2019/06/19/a-gentle-intro-to-tidymodels/)\n\nSeyedian, A. (2021). [Medical cost personal datasets. Insurance forcast by using linear regression](https://www.r-bloggers.com/2021/02/using-tidymodels-to-predict-health-insurance-cost/)\n\nSilge, J. (2020). [Get started with tidymodels and #TidyTuesdag Palmer penguins](https://juliasilge.com/blog/palmer-penguins/)\n\nSilge, J. (2021). [Supervised machine learning case studies in R](https://supervised-ml-course)\n\nTidymodels. [Tidymodels website](https://www.tidymodels.org/)\n\n\n\n",
    "supporting": [
      "machine-learning-workflow_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"..\\..\\site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\r\n<link href=\"..\\..\\site_libs/vis-9.1.0/vis-network.min.css\" rel=\"stylesheet\" />\r\n<script src=\"..\\..\\site_libs/vis-9.1.0/vis-network.min.js\"></script>\r\n<script src=\"..\\..\\site_libs/visNetwork-binding-2.1.0/visNetwork.js\"></script>\r\n<script src=\"..\\..\\site_libs/FileSaver-1.1.20151003/FileSaver.min.js\"></script>\r\n<script src=\"..\\..\\site_libs/Blob-1.0/Blob.js\"></script>\r\n<script src=\"..\\..\\site_libs/canvas-toBlob-1.0/canvas-toBlob.js\"></script>\r\n<script src=\"..\\..\\site_libs/html2canvas-0.5.0/html2canvas.js\"></script>\r\n<script src=\"..\\..\\site_libs/jspdf-1.3.2/jspdf.debug.js\"></script>\r\n<script src=\"..\\..\\site_libs/jquery-1.11.3/jquery.min.js\"></script>\r\n<link href=\"..\\..\\site_libs/jquery-sparkline-2.1.2/jquery.sparkline.css\" rel=\"stylesheet\" />\r\n<script src=\"..\\..\\site_libs/jquery-sparkline-2.1.2/jquery.sparkline.js\"></script>\r\n<script src=\"..\\..\\site_libs/sparkline-binding-2.0/sparkline.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}